#!/bin/bash

function get_sink_id() {
    defaultSinkId=$(pactl --format=json list sinks | \
                    jq ".[] | select(.name == \"$(pactl get-default-sink)\") | 
                        .properties | 
                        .[\"object.id\"] | 
                        tonumber")

    echo $defaultSinkId
}

function percent() {
    volume=$(wpctl get-volume $(get_sink_id) | awk '{ print $2 }')
    percent=$(echo - | awk "{ print $volume * 100 }")
    echo $percent
}

function muted() {
    echo $(pactl --format=json list sinks | jq ".[] | select(.name == \"$(pactl get-default-sink)\") | 
                                                      .mute")
}

function icon() {
    local volume=$(percent)
    local muted=$(muted)

    if [[ $muted == "true" ]]; then
        echo ""
    elif (( $volume <= 33 )); then
        echo ""
    elif (( $volume <= 66 )); then
        echo ""
    elif (( $volume <= 100 )); then
        echo ""
    fi
}

if [[ -n $1 && $1 == "percent" ]]; then
    echo $(percent)
elif [[ -n $1 && $1 == "icon" ]]; then
    echo $(icon)
elif [[ -n $1 && $1 == "muted" ]]; then
    echo $(muted)
fi
