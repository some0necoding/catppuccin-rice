"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4114],{26862:(e,t,r)=>{r.r(t),r.d(t,{TransferWorkspaceModal:()=>F});var a=r(77094),o=r.n(a),i=r(67294),n=r(480),s=r(81954),l=r(24405),d=r(33728),c=r(5366),u=r(97880),p=r(50906),m=r(54642),f=r(47307),g=r(29974),h=r(28020),v=r(79315),y=r(17364),k=r(1743),w=r(22346),S=r(19889),C=r(82990),b=r(3815),M=r(42922),I=r(61519),T=r(74194),W=r(89728),x=r(64369),U=r(3779),Z=r(70043),V=r(33665),B=r(73063),E=r(16354),K=r(45653);const q={inputLabel:{fontWeight:C.Z.fontWeight.medium,fontSize:14,letterSpacing:-.15,textAlign:"left",width:"100%"},input:{width:"100%",marginTop:8}};function _(e){window.__c={n:"TransferModalHeader"};const t=(0,l.yK)((e=>({avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},avatarContainerBadged:{position:"relative"},avatarBadgeIcon:{position:"absolute",left:26,top:26,height:20,width:20},exclamationMarkIcon:{width:"100%",height:18,fill:e.accentColors.yellow[500],stroke:e.modalBackground,strokeWidth:3,paintOrder:"stroke fill",overflow:"visible"},arrowRightIcon:{width:16,height:16,marginLeft:12,marginRight:12,fill:e.mediumIconColor},questionMarkIcon:{width:20,height:20,fill:e.mediumIconColor},userIconPlaceholder:{width:40,height:40,borderRadius:"50%",backgroundColor:e.modalBackground,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:Z.v.avatarBoxShadow.light,boxSizing:"content-box",border:`1px solid ${e.lightDividerColor}`},headerStyle:{textAlign:"center"},titleContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:15},title:{fontSize:16,fontWeight:C.Z.fontWeight.medium},description:{marginTop:5,fontWeight:C.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:-.08}})),[]);return o()("div",{style:t.headerStyle},void 0,o()("div",{style:t.avatarContainer},void 0,o()("div",{style:t.avatarContainerBadged},void 0,o()(K.Z,{size:40,userValue:e.fromUserValue,avatarShouldShowShadow:!0}),o()("div",{style:t.avatarBadgeIcon},void 0,U.Z.warning(t.exclamationMarkIcon))),U.Z.arrowRight(t.arrowRightIcon),e.targetUserValue?o()(K.Z,{size:40,userValue:e.targetUserValue,avatarShouldShowShadow:!0}):o()("div",{style:t.userIconPlaceholder},void 0,U.Z.questionMark(t.questionMarkIcon))),o()("div",{style:t.titleContainer},void 0,o()(x.Z,{style:t.title},void 0,o()(c.FormattedMessage,{defaultMessage:"Change workspace account",id:"transferWorkspaceModal.changeAccount.title",description:"Title for transfer workspace modal asking use to change accounts."})),o()(E.Z,{href:(0,V.UY)("guides.domainManagement")},void 0,o()(B.Z,{icon:U.Z.help}))),o()(x.Z,{isSecondaryColor:!0,isMultiline:!0,style:t.description},void 0,e.description))}function L(){window.__c={n:"BackToMyWorkspacesButton"};const e=(0,n.O7)(),t=(0,l.yK)((e=>({backIconStyle:{width:12,height:12,marginRight:7,fill:e.mediumIconColor},secondaryButton:{marginTop:12,justifyContent:"center",fontWeight:C.Z.fontWeight.medium,color:e.lightTextColor,letterSpacing:"-0.154px"}})),[]),r=(0,s.VK)((()=>v.default.state.currentUserRootStore),[]),a=(0,s.VK)((()=>v.default.state.currentUserSettingsStore),[]),d=(0,s.VK)((()=>r&&a),[r,a]),u=(0,i.useCallback)((async()=>{r&&a&&await g.L5({environment:e,userRootStore:r,userSettingsStore:a,skipPendingTransferWorkspaces:!0})}),[e,r,a]);return o()(W.Z,{style:t.secondaryButton,onClick:u,disabled:!d},void 0,U.Z.commentReply(t.backIconStyle),o()(c.FormattedMessage,{id:"transferWorkspaceModal.backToMyWorkspacesButton.label",defaultMessage:"Back to my workspaces",description:"Return to first workspace that does not have a transfer workspace request on it."}))}function N(e){const{currentSpaceStore:t,currentUserValue:r,targetUserId:a,handleConfirm:n,handleBack:d,intl:u}=e,p=(0,l.yK)((e=>({primaryButton:{width:"100%",marginBottom:"10px",marginTop:32},secondaryButton:{color:e.mediumTextColor,fontWeight:C.Z.fontWeight.medium},emailFieldCaption:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor},inputLabel:q.inputLabel,verificationCodeInputContainer:{marginTop:13},input:q.input,inputContainer:{marginTop:27,width:"100%"},dividerContainer:{marginTop:29},dividerInner:{borderBottomColor:e.regularDividerColor}})),[]),m=(0,s.VK)((()=>t.getName()),[t]),f=(0,s.VK)((()=>b.U6.createChildStore(t,{id:a,table:S.KJ}).getValue()),[t,a]),g=(0,s.VK)((()=>b.U6.createChildStore(t,{id:a,table:S.KJ}).getEmail()),[t,a]),[h,v]=(0,i.useState)(""),y=(0,i.useCallback)((e=>{v(e.currentTarget.value)}),[v]),k=(0,i.useCallback)((async()=>{await n(h)}),[h,n]);return i.createElement(i.Fragment,null,o()(_,{fromUserValue:r,targetUserValue:f,description:o()(c.FormattedMessage,{defaultMessage:"Transfer {currentSpaceName} to the Notion account associated with {targetUserEmail}.",id:"transferWorkspaceModal.confirmTransfer.description",values:{currentSpaceName:m,targetUserEmail:g},description:"Describes that by pressing confirm, the user agrees to transfer workspace to user associated with the given email."})}),o()(I.Z,{size:"100%",innerStyle:p.dividerInner,style:p.dividerContainer}),o()("div",{style:p.inputContainer},void 0,o()(x.Z,{style:p.inputLabel},void 0,o()(c.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.emailLabel",defaultMessage:"Email",description:"Label for the personal user account email info."})),o()(T.Z,{style:p.input,value:g,disabled:!0}),o()(x.Z,{isSecondaryColor:!0,style:p.emailFieldCaption},void 0,o()(c.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.emailDescription",defaultMessage:"We just sent you a temporary verification code.{br}Please check your inbox.",values:{br:o()("br",{})},description:"Informs user that a verification code was sent to the above email address."})),o()("div",{style:p.verificationCodeInputContainer},void 0,o()(x.Z,{style:p.inputLabel},void 0,o()(c.FormattedMessage,{id:"transferWorkspaceModal.confirmTransfer.passcodeLabel",defaultMessage:"Verification code",description:"Label for user to input the email verification code."})))),o()(T.Z,{style:p.input,value:h,onChange:y,onSubmit:k,placeholder:u.formatMessage({id:"transferWorkspaceModal.confirmTransfer.passcodePlaceholder",defaultMessage:"Enter verification code...",description:"Placeholder text for the email verification code input."}),focusInitial:!0}),o()(M.Z,{style:p.primaryButton,onClick:k},void 0,o()(c.FormattedMessage,{defaultMessage:"Confirm transfer",id:"transferWorkspaceModal.confirmTransfer.confirmButton",description:"Button to confirm workspace transfer"})),o()(W.Z,{style:p.secondaryButton,onClick:d},void 0,o()(c.FormattedMessage,{defaultMessage:"Cancel",id:"transferWorkspaceModal.confirmTransfer.cancelButton",description:"Button that allows user to quit the flow and input a different user account."})))}var R=r(90468);function D(e){const{currentUserValue:t,currentSpaceStore:r,workspaceTransfer:a,intl:n,handleSubmitEmail:d}=e,u=(0,l.yK)((e=>({primaryButton:{width:"100%",marginTop:32},emailLabel:q.inputLabel,emailInput:q.input,dividerContainer:{marginTop:29},dividerInner:{borderBottomColor:e.regularDividerColor},emphasizedDescriptionText:{fontWeight:C.Z.fontWeight.medium},inputContainer:{marginTop:27,width:"100%"}})),[]),p=(0,s.VK)((()=>t.email),[t]),m=(0,s.VK)((()=>null==r?void 0:r.getName()),[r]),f=(0,s.VK)((()=>b.H2.createChildStore(r,{table:R.bx,id:a.requested_from_space_id}).getName()),[r,a]),[g,h]=(0,i.useState)(""),v=(0,i.useCallback)((()=>{d(g)}),[g,d]);return i.createElement(i.Fragment,null,o()(_,{fromUserValue:t,description:o()(c.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.description",defaultMessage:"{currentWorkspaceName} is associated with {currentUserEmail}. {requestingWorkspaceName} owns {currentUserEmailDomain} and requires that you switch to a personal Notion account to continue using this workspace.{br}{br}Contact {contactEmail} for assistance.",values:{br:o()("br",{}),currentWorkspaceName:m,currentUserEmail:p,currentUserEmailDomain:p.split("@")[1],requestingWorkspaceName:f,contactEmail:o()("span",{style:u.emphasizedDescriptionText},void 0,a.contact_email)},description:"Describes the current workspace being owned by the current user, but a workspace transfer is requested to change ownership of another Notion account."})}),o()(I.Z,{size:"100%",innerStyle:u.dividerInner,style:u.dividerContainer}),o()("div",{style:u.inputContainer},void 0,o()(x.Z,{style:u.emailLabel},void 0,o()(c.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.emailLabel",defaultMessage:"Email",description:"Label for the personal user account email input."})),o()(T.Z,{style:u.emailInput,value:g,onChange:e=>{h(e.currentTarget.value)},onSubmit:v,placeholder:n.formatMessage({id:"transferWorkspaceModal.transferRequested.emailPlaceholder",defaultMessage:"Personal-use, Notion account email address...",description:"Placeholder prompt for user to enter a personal Notion account email."}),focusInitial:!0})),o()(M.Z,{isLarge:!0,style:u.primaryButton,onClick:v},void 0,o()(c.FormattedMessage,{id:"transferWorkspaceModal.transferRequested.continueButton",defaultMessage:"Continue with email",description:"Button to continue transfer flow using the account associated with the inputted email."})),o()(L,{}))}function F(e){window.__c={n:"TransferWorkspaceModal"};const{workspaceTransfer:t}=e,r=(0,n.O7)(),a=(0,c.useIntl)(),S=(0,s.VK)((()=>v.default.state.currentSpaceStore),[]),C=(0,s.VK)((()=>v.default.state.currentUserStore),[]),b=(0,s.VK)((()=>v.default.state.currentUserRootStore),[]),M=(0,s.VK)((()=>v.default.state.currentUserSettingsStore),[]),[I,T]=(0,i.useState)({type:"requested"}),W=(0,s.VK)((()=>{var e;return null===(e=(0,h.B7)(r))||void 0===e?void 0:e.getValue()}),[r]),x=(0,l.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center"}})),[]);if(!S||!C||!W)return null;let U;switch(I.type){case"requested":const e=async e=>{const t=await m.sendVerifyTransferEmail(r,{email:e});"failed"!==t.type?T({type:"confirm",targetUserId:t.data.userId,targetUserEmailDomain:(0,d.Gd)(e)}):f.showError(t)};U=o()(D,{currentUserValue:W,currentSpaceStore:S,workspaceTransfer:t,handleSubmitEmail:e,intl:a});break;case"confirm":const i=async e=>{const a=I.targetUserId,o=await m.transferWorkspaceToUser(r,{targetUserId:a,spaceId:S.id,transferEmailPasscode:e});if("failed"===o.type)return f.showError(o),void T({type:"requested"});p.trackSpaceTransferCompleted(r,{newOwner:a,newEmailDomain:I.targetUserEmailDomain||"__UNKNOWN_EMAIL_DOMAIN__",requestingSpaceId:t.requested_from_space_id});const i=y.Z.getSpaceViewStores(r,a).find((e=>e.getSpaceId()===S.id));return i?void(await g.y3({environment:r,userRootStore:b,userSettingsStore:M,spaceViewStore:i})):b&&M?(await g.L5({environment:r,userRootStore:b,userSettingsStore:M,skipPendingTransferWorkspaces:!0}),void T({type:"requested"})):void 0};U=o()(N,{currentSpaceStore:S,currentUserValue:W,targetUserId:I.targetUserId,handleBack:()=>T({type:"requested"}),handleConfirm:i,intl:a});break;default:(0,u.t1)(I)}return o()(k.Z,{capture:!0},void 0,o()(w.Z,{open:!0,innerStyle:x.modalInnerStyle,onDismiss:()=>{},render:()=>U}))}}}]);