"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3370],{61695:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Te});var o=i(77094),a=i.n(o),n=i(67294),s=i(480),r=i(81954),l=i(24405),d=i(63123),c=i(15070),p=i(8848),u=i(59054),g=i(56589),m=i(4615),h=i(77420),v=i(9844),f=i(19889),w=i(90965),b=i(97880),y=i(82990),S=i(5978),A=i(29974),k=i(21325),M=i(71935),I=i(38755),P=i(21115),x=i(79315),_=i(3815),N=i(62213),T=i(78291),C=i(12318),z=i(3403),V=i(3779),F=i(5366),Z=i(82036),B=i(36110),L=i(42922),W=i(63296),O=i(42402);function E(e){window.__c={n:"OauthAuthorizationError"};const{integrationValue:t,oauthParams:i}=e,o=(0,s.O7)(),{oauthErrorType:n,title:r,body:d,primaryAction:c}=function(e){const t=a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.genericError.title",defaultMessage:"Something went wrong"});if("invalidClientId"===e.type)return{oauthErrorType:Z._.invalid_request,title:t,body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidClientId.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(O.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,e)}})};if("clientNotFound"===e.type)return{oauthErrorType:Z._.invalid_request,title:t,body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.clientNotFound.body",defaultMessage:"Missing or incomplete Client ID. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(O.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,e)}})};if("invalidResponseType"===e.type)return{oauthErrorType:Z._.invalid_request,title:t,body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidResponseType",defaultMessage:"Missing or invalid response_type. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(O.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,e)},description:"Do not translate 'response_type', it's code."})};if("integrationAlreadyInstalled"===e.type)return{oauthErrorType:Z._.access_denied,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.title",defaultMessage:"This integration has already been added to {workspaceName}",values:{workspaceName:e.spaceName}}),body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.body",defaultMessage:"You can review and remove added integrations in Settings."}),primaryAction:{onClick:e.primaryAction,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationAlreadyInstalled.openWorkspaceSettingsButton.label",defaultMessage:"Open Settings"})}};if("notAnAdmin"===e.type)return{oauthErrorType:Z._.access_denied,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.title",defaultMessage:"You're not allowed to add integrations to {workspaceName}",values:{workspaceName:e.spaceName}}),body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.body",defaultMessage:"Contact an admin to grant you access, or switch to another workspace."}),primaryAction:{onClick:e.primaryAction,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.switchWorkspaceButton.label",defaultMessage:"Switch workspace"})}};if("integrationNotApproved"===e.type)return{oauthErrorType:Z._.access_denied,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationNotApproved.title",defaultMessage:'You are not permitted to add the integration "{integrationName}" to {workspaceName}',values:{integrationName:e.integrationValue.name,workspaceName:e.spaceName}}),body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.integrationNotApproved.body",defaultMessage:"Contact your system administrator for more information."}),primaryAction:{onClick:e.primaryAction,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.notAnAdmin.switchWorkspaceButton.label",defaultMessage:"Switch workspace"})}};if("invalidRedirectUri"===e.type)return{oauthErrorType:Z._.invalid_request,title:t,body:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidRedirectUri.body",defaultMessage:"Missing or invalid redirect_uri. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>a()(O.Z,{href:"https://developers.notion.com/#handling-errors"},void 0,e)},description:"Do not translate 'redirect_uri', it's code."})};(0,b.t1)(e.type)}(e),u=function(){const{isMobile:e}=(0,s.Fy)(),t=e?25:48,i=e?18:20;return(0,l.yK)((()=>({container:{textAlign:"center",flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},icon:{fill:p.ZP.red,width:t,height:t,marginBottom:20,display:"inline-block"},title:{fontSize:i,margin:"0 50px 32px",textAlign:"center",fontWeight:y.Z.fontWeight.medium,marginBottom:12},body:{marginTop:0,marginBottom:24,width:"80%"}})),[t,i])}();return a()("section",{style:u.container},void 0,V.Z.genericError(u.icon),a()("header",{style:u.title},void 0,r),a()("p",{style:u.body},void 0,d),c&&a()("div",{style:u.body},void 0,a()(L.Z,{isLarge:!0,onClick:c.onClick},void 0,c.title)),a()(W.Z,{onClick:()=>{B.VW({environment:o,integration:t,errorType:n,params:i})}},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.cancelButton.label",defaultMessage:"Cancel"})))}var R=i(97464),K=i.n(R),U=i(26825),D=i(50906),j=i(76463),Y=i(92625),H=i(41623),q=i(30874),G=i(31278),$=i(67669),J=i(92222);function Q(e){window.__c={n:"OauthAuthorizationBotAccessOptionsStep"};const{integrationValue:t,validIntegrationTemplateId:i,botAccessOption:o,setBotAccessOption:s}=e,[{value:r}]=(0,u.r5)((async()=>!!i&&await(0,$.JI)(i)),[i]);n.useEffect((()=>{s(r?"duplicate_template":"pick_pages")}),[r,s]);const d=(0,l.yK)((()=>({container:{display:"grid",gridTemplateRows:"1fr 1fr",gap:8,marginTop:8},icon:{fill:p.ZP.red,width:20,height:20,marginRight:12},errorContainer:{display:"flex",alignItems:"center"}})),[]);return a()("div",{style:d.container},void 0,a()(X,{disabled:!r,title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.useTemplate.title",defaultMessage:"Use a template provided by the developer",description:"The user will select this option if they want to duplicate a template when installing an integration."}),subtitle:r?a()(F.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.useTemplate.subtitle",defaultMessage:"{integrationName} will duplicate this template into the Private pages of your workspace. The integration will then be able to {capabilities} content in this new page.",description:"Explains what will happen when a user decides to duplicate a template when installing an integration.",values:{capabilities:a()(F.FormattedList,{value:(0,J.O)(t.capabilities),type:"conjunction"}),integrationName:t.name}}):a()("div",{style:d.errorContainer},void 0,a()("div",{},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.error.invalidTemplate.body",defaultMessage:"The page template is no longer public. <inlinetextlink>Contact the developer</inlinetextlink> for more help.",values:{inlinetextlink:t=>a()(O.Z,{href:`mailto:${e.integrationValue.info.email}`},void 0,t)},description:"This error message appears when a user tries to install an integration with a template but the template is invalid."}))),icon:V.Z.pageAdd,isSelected:"duplicate_template"===o,selectOption:()=>s("duplicate_template")}),a()(X,{title:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.pickPages.title",defaultMessage:"Select pages to share with {integrationName}",description:"The user will select this option if they want to give bot access to existing pages.",values:{integrationName:t.name}}),subtitle:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.botAccessOption.pickPages.subtitle",defaultMessage:"Select one or multiple pages to share with {integrationName}",description:"Explains what will happen when a user decides to give bot access to existing pages.",values:{integrationName:t.name}}),icon:V.Z.taskList,isSelected:"pick_pages"===o,selectOption:()=>s("pick_pages")}))}function X(e){window.__c={n:"BotAccessOptions"};const{title:t,subtitle:i,icon:o,isSelected:n,selectOption:s,disabled:r}=e,d=(0,l.yK)((e=>({button:{height:"none",padding:12,width:"100%",borderWidth:1,borderColor:e.outlineButtonBorder,borderRadius:4,cursor:r?"not-allowed":void 0},buttonSelected:{background:"white",borderWidth:2,borderColor:p.ZP.blue,padding:11,boxShadow:"0px 4px 8px rgba(66, 129, 219, 0.09), 0px 0px 2px rgba(0, 0, 0, 0.06), 0px 0px 1px rgba(0, 0, 0, 0.04)"},option:{width:"100%",whiteSpace:"normal",display:"grid",gridTemplateColumns:"min-content auto min-content",padding:6},text:{overflowWrap:"normal"},title:{fontSize:14,fontWeight:y.Z.fontWeight.medium,color:p.ZP.frontTextMedium,marginBottom:6},subtitle:{fontSize:12,lineHeight:"140%",color:e.mediumTextColor},icon:{width:14,height:14,color:p.ZP.regularIconColor,marginRight:12}})),[r]);return a()(W.Z,{onClick:s,style:d.button,hovered:n,hoveredStyle:d.buttonSelected,pressedStyle:d.buttonSelected,disabled:r},void 0,a()("div",{style:d.option},void 0,o(d.icon),a()("div",{style:d.text},void 0,a()("div",{style:d.title},void 0,t),a()("div",{style:d.subtitle},void 0,i))))}var ee=i(74181),te=i(11106);function ie(e){const{integrationValue:t,selectedBlockIdsStore:i}=e,o=(0,ee.VM)(t),s=(0,l.yK)((e=>({subtitle:{fontSize:14,textAlign:"center",fontWeight:y.Z.fontWeight.medium,marginBottom:16},linkPreviewSubtitle:{fontSize:14,textAlign:"left",marginBottom:16,color:e.lightTextColor}})),[]);return n.createElement(n.Fragment,null,a()("div",{style:s.subtitle},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.title",defaultMessage:'Allow "{integrationName}" to access these pages',values:{integrationName:t.name}})),a()("div",{style:s.linkPreviewSubtitle},void 0,o&&a()(F.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.linkPreviewSubtitle",defaultMessage:"Your selections here will not impact this integration's ability to unfurl links across your workspace",description:"Link preview subtitle if user is adding an integration with link preview capabilities"})),a()(te.Z,{selectedBlockIdsStore:i}))}function oe(e){var t,i,o,s,r,d,c,p,u;const{integrationValue:g,spaceName:m}=e,h=g.info.website_url,v=(0,U.FD)(g.capabilities),f=(0,l.yK)((()=>({inlineTextLink:{color:"black",textDecoration:"none"}})),[]);return n.createElement(n.Fragment,null,a()("div",{},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.intro",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> will have permission to",values:{integrationName:g.name,inlinetextlink:e=>h?a()(O.Z,{href:h,style:f.inlineTextLink},void 0,e):e}})),(null===(t=g.capabilities)||void 0===t?void 0:t.read_content)&&a()(ae,{icon:V.Z.eye,title:a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContentWithInheritedAccess",defaultMessage:"View pages you have access to",description:"Title for a bot permission that allows the bot to view whatever pages its installing user can view."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContent",defaultMessage:"View pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to view pages you can view.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to view whatever pages its installing user can view."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readContent.description",defaultMessage:'"{integrationName}" will be able to view pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:g.name}})),(null===(i=g.capabilities)||void 0===i?void 0:i.update_content)&&a()(ae,{icon:V.Z.scribble,title:a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContentWithInheritedAccess",defaultMessage:"Edit pages you have access to",description:"Title for a bot permission that allows the bot to edit whatever pages its installing user can edit."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContent",defaultMessage:"Edit pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to edit pages you can edit.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to edit whatever pages its installing user can edit."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.updateContent.description",defaultMessage:'"{integrationName}" will be able to edit pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:g.name}})),(null===(o=g.capabilities)||void 0===o?void 0:o.insert_content)&&a()(ae,{icon:V.Z.pageAdd,title:a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContentWithInheritedAccess",defaultMessage:"Create new content within pages you have access to",description:"Title for a bot permission that allows the bot to add new content wherever its installing user can add new content."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContent",defaultMessage:"Create new content within pages you select",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to add new content or sub-pages wherever you have permission to add new content or sub-pages.',values:{integrationName:g.name,workspaceName:m},description:"Description for a bot permission that allows the bot to add new content wherever its installing user can add new content."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertContent.description",defaultMessage:'"{integrationName}" will be able to add new content or sub-pages to pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:g.name,workspaceName:m}})),(null===(s=g.capabilities)||void 0===s?void 0:s.read_comment)&&a()(ae,{icon:V.Z.topbarComment,title:a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readCommentWithInheritedAccess",defaultMessage:"View comments within pages you have access to",description:"Title for a bot permission that allows the bot to view comments within pages its installing user can access."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readComment",defaultMessage:"View comments within pages you select",description:"Title for a bot permission that allows the bot to view comments within pages its installing user selects."})},void 0,a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readCommentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to view comments within pages you can access.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to view comments within pages its installing user can access."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.readComment.description",defaultMessage:'"{integrationName}" will be able to view comments within pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to view comments within pages its installing user selects."})),(null===(r=g.capabilities)||void 0===r?void 0:r.insert_comment)&&a()(ae,{icon:V.Z.topbarCommentFilled,title:a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertCommentWithInheritedAccess",defaultMessage:"Create comments within pages you have access to",description:"Title for a bot permission that allows the bot to create comments within pages its installing user can access."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertComment",defaultMessage:"Create comments within pages you select",description:"Title for a bot permission that allows the bot to create comments within pages its installing user selects."})},void 0,a()(F.FormattedMessage,v?{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertCommentWithInheritedAccess.description",defaultMessage:'"{integrationName}" will be able to create comments within pages you can access.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to create comments within pages its installing user can access."}:{id:"oauthAuthorizationPage.permissionStep.permissionListItem.insertComment.description",defaultMessage:'"{integrationName}" will be able to create comments within pages you select in the next step. You can also share pages later with "{integrationName}" in Notion.',values:{integrationName:g.name},description:"Description for a bot permission that allows the bot to create comments within pages its installing user selects."})),((null===(d=g.capabilities)||void 0===d?void 0:d.read_user_without_email)||(null===(c=g.capabilities)||void 0===c?void 0:c.read_user_with_email))&&a()(ae,{icon:V.Z.settingsMembersFilled,title:null!==(p=g.capabilities)&&void 0!==p&&p.read_user_with_email?a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsersAndEmail",defaultMessage:"View workspace users and their emails",description:"This is one of the things an integration can do once it's added to a user's workspace."}):a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers",defaultMessage:"View workspace users",description:"This is one of the things an integration can do once it's added to a user's workspace."})},void 0,null!==(u=g.capabilities)&&void 0!==u&&u.read_user_with_email?a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsersAndEmail.detail",defaultMessage:'"{integrationName}" will be able to see basic information about all workspace members and guest data, including their names, profile images, and email addresses.',values:{integrationName:g.name}}):a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.permissionListItem.viewUsers.detail",defaultMessage:'"{integrationName}" will be able to see basic information about all workspace members and guests, like their names and profile images, but not their email addresses.',values:{integrationName:g.name}})))}function ae(e){window.__c={n:"PermissionDetailToggle"};const[t,i]=n.useState(!1),o=(0,l.yK)((e=>({permissionItem:{border:`1px ${p.FN.dark.gray[850]} solid`,borderRadius:4,marginTop:8},permissionItemTitle:{display:"flex",justifyContent:"space-between",padding:"6px 12px",cursor:"pointer",userSelect:"none"},permissionItemHeading:{display:"flex",alignItems:"center"},permissionItemDetails:{paddingLeft:38,paddingRight:24,transition:"all 0.2s ease",color:e.mediumTextColor},rightStyle:{width:22,height:18},sharedIconStyle:{width:24,height:16,textAlign:"center"}})),[]);return a()("div",{style:o.permissionItem},void 0,a()("div",{style:o.permissionItemTitle,onClick:()=>i(!t)},void 0,a()("div",{style:o.permissionItemHeading},void 0,a()("div",{style:o.sharedIconStyle},void 0,e.icon({width:16,height:16,color:p.ZP.regularIconColor})),a()("div",{},void 0,e.title)),e.children&&a()("div",{style:{display:"flex",alignItems:"center"}},void 0,V.Z.chevronDownThin({width:12,height:12,color:p.ZP.lightIconColor,transform:t?"rotate(180deg)":void 0,transition:"transform 0.2s ease"}))),a()("div",{style:{...o.permissionItemDetails,opacity:t?1:0,flex:t?1:0,paddingBottom:t?8:0,transform:t?"translate3d(0,-4px,0)":"translate3d(0,-8px,0)"}},void 0,t&&e.children))}const ne={permissions:{header:!0,warning:!0,footer:!0},bot_access_option:{header:!0,warning:!1,footer:!0},page_picker:{header:!1,warning:!1,footer:!1}},se=(0,F.defineMessages)({loadingMessage:{id:"oauthAuthorization.loadingMessage",defaultMessage:"Authorizing…",description:"Loading modal shown when user is authorizing a Notion Integration from our OAuth screen."}});function re(e){const{showApprovalWarning:t}=e,[i,o]=n.useState("permissions"),[s,r]=n.useState("duplicate_template"),l=ne[i].header,d=t&&ne[i].warning,c=ne[i].footer;return n.createElement(n.Fragment,null,l&&n.createElement(pe,e),n.createElement(ue,K()({},e,{currentStep:i,botAccessOption:s,setBotAccessOption:r})),n.createElement(ge,K()({},e,{currentStep:i,setCurrentStep:o,botAccessOption:s})),d&&a()("div",{style:{display:"flex",alignItems:"center",marginTop:20}},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.integrationApprovalNotice",defaultMessage:"Authorizing this integration will add it to your workspace's approval list. Other workspace members will be able to install this integration."})),c&&n.createElement(me,e))}function le(){const{isMobile:e}=(0,s.Fy)();return(0,l.yK)((t=>({title:{fontSize:e?18:20,margin:"0 50px 32px",textAlign:"center",fontWeight:y.Z.fontWeight.medium},inlineTextLink:{color:"black",textDecoration:"none"},buttonGroup:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:24},footer:{fontSize:y.Z.fontSize.UISmall.desktop,color:t.mediumTextColor,paddingTop:32,paddingBottom:16},innerFooterContainer:{color:t.regularTextColor,fontWeight:y.Z.fontWeight.semibold,marginBottom:4}})),[e])}const de={cancel:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.cancelButton.label",defaultMessage:"Cancel"}),back:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.backButton.label",defaultMessage:"Back",description:"Text for a button that will take the user back to the previous page"})},ce={bot_access_option:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.nextButton.label",defaultMessage:"Next",description:"This button will take a user to the next screen in the OAuth flow for installing integrations."}),page_picker:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.continueButton.label",defaultMessage:"Select pages",description:"This button will take a user to a screen where they can choose pages to share with an integration."}),authorize:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.selectPagesStep.finishButton.label",defaultMessage:"Allow access",description:"This button, once clicked, adds an integration to a user's workspace and automatically gives it access to a set of pages the user selected."})};function pe(e){const{integrationValue:t,spaceName:i}=e,o=t.info.website_url,s=t.info.icon?{pointer:{table:v.K2,id:t.id},icon:t.info.icon}:void 0,r=le();return n.createElement(n.Fragment,null,a()("div",{style:{padding:15}},void 0,a()(G.Z,{icon:s,disabled:!0,title:t.name,size:54,isEmptyPage:!1,style:{margin:"auto"}})),a()("div",{style:r.title},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.title",defaultMessage:"<inlinetextlink>{integrationName}</inlinetextlink> is requesting access to {workspaceName}",values:{integrationName:t.name,workspaceName:i,inlinetextlink:e=>o?a()(O.Z,{style:r.inlineTextLink,href:o},void 0,e):e}})))}function ue(e){const{currentStep:t,integrationValue:i,spaceName:o}=e;return"permissions"===t?a()(oe,{integrationValue:i,spaceName:o}):"bot_access_option"===t?n.createElement(Q,K()({},e,{integrationValue:i})):"page_picker"===t?n.createElement(ie,K()({},e,{integrationValue:i})):void(0,b.t1)(t)}function ge(e){window.__c={n:"OptionButtons"};const{currentStep:t,setCurrentStep:i,integrationValue:o,validIntegrationTemplateId:l,oauthParams:d,botAccessOption:c,spaceId:p,selectedBlockIdsStore:u}=e,g=(0,s.O7)(),[m,h]=n.useState(!1),v=(0,r.VK)((()=>u.state),[u]),f=(0,r.VK)((()=>{const e=q.Z.state;return(0,H.y)({integrationId:o.id,externalIntegrationStoreState:e})}),[o]),w=function(e){const{integrationValue:t,validIntegrationTemplateId:i,botAccessOption:o}=e;if((0,U.FD)(t.capabilities))return["permissions"];if(i){if("duplicate_template"===o)return["permissions","bot_access_option"];if("pick_pages"===o)return["permissions","bot_access_option","page_picker"];(0,b.t1)(o)}return["permissions","page_picker"]}({integrationValue:o,validIntegrationTemplateId:l,botAccessOption:c}),y=w.indexOf(t),A=w[y-1],k=w[y+1],M=A?de.back:de.cancel,I=A?()=>{i(A)}:()=>{!function(e){const{environment:t,oauthParams:i,integrationValue:o,createdBotValue:a}=e;a?S.handleRedirectToLastVisitedPage(t):B.VW({environment:t,params:i,integration:o,errorType:Z._.access_denied})}({environment:g,oauthParams:d,integrationValue:o,createdBotValue:f})},P=k?ce[k]:ce.authorize,_=k?()=>{i(k)}:()=>{!async function(e){const{environment:t,botAccessOption:i,integrationValue:o,setIsLoading:a,oauthParams:n,spaceId:s,selectedBlockIds:r,createdBotValue:l}=e;let d;"duplicate_template"===i&&(d=o.info.template_page_id),a(!0),Y.j({message:se.loadingMessage});const c=d?[]:Object.keys(r).filter((e=>r[e])),{currentSpaceStore:p,currentSpaceViewStore:u}=x.default.state;if(l){const e=await j.k2({environment:t,templatePageId:d,botValue:l,spaceStore:p,spaceViewStore:u,pages:c});e?S.navigateToBlock({environment:t,store:e}):S.handleRedirectToLastVisitedPage(t)}else await B.VW({environment:t,params:n,integration:o,spaceId:s,blockIdsForBot:c,templatePageId:d}),D.trackInstallPublicIntegrationOauth(t,{selection:i});Y.x(),a(!1)}({environment:g,botAccessOption:c,integrationValue:o,setIsLoading:h,oauthParams:d,spaceId:p,selectedBlockIds:v,createdBotValue:f})},N=le();return a()("div",{style:N.buttonGroup},void 0,a()(W.Z,{isLarge:!0,onClick:I,style:{height:32}},void 0,M),a()(L.Z,{isLarge:!0,onClick:_,disabled:m},void 0,P))}function me(e){window.__c={n:"Footer"};const{integrationValue:t,oauthParams:i}=e,o=t.info.terms_of_use_url,n=t.info.privacy_policy_url,s=(i.redirectUri||t.redirect_uris[0]||"").replace("http://","").replace("https://","").split(/[/?#]/)[0],r=le();return a()("footer",{style:r.footer},void 0,a()("div",{style:r.innerFooterContainer},void 0," ",a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.title",defaultMessage:'Make sure you trust "{integrationName}" ({redirectUriDomain})',values:{integrationName:t.name,redirectUriDomain:s}})),a()("div",{},void 0,a()(F.FormattedMessage,{id:"oauthAuthorizationPage.permissionStep.warning.body",defaultMessage:'If you continue, you may be sharing sensitive information. Notion does not review third party integrations such as "{integrationName}". Learn how "{integrationName}" handles your data by reviewing their <privacypolicylink>Privacy Policy</privacypolicylink> and <termsofservicelink>Terms of Service</termsofservicelink>.',values:{integrationName:t.name,privacypolicylink:e=>n?a()(O.Z,{href:n},void 0,e):e,termsofservicelink:e=>o?a()(O.Z,{href:o},void 0,e):e}})))}var he=i(95182),ve=i(28125),fe=i(45094),we=i(81236),be=i(17364),ye=i(72495),Se=i(1101),Ae=i(98285),ke=i(34011),Me=i(31280);class Ie extends Me.g6{renderAccountHeader(e){const t=be.Z.getUserEmailAddress(this.environment,e);return t&&a()(Se.Z,{emailAddress:t,userId:e,disabled:!1,accountActions:[(0,he.qu)(e)]})}renderFooter(){return a()("div",{style:this.getFooterStyle()},void 0,a()(ye.Z,{},void 0,ve.kH(this.environment)&&n.createElement(Ae.Z,K()({createType:"add-account",disableLoginLink:this.props.disableLoginLink},this.stores))))}getMenuListSections(e){const{device:t}=this.environment;return[{key:"spaces",render:e=>n.createElement(ye.Z,K()({},e,{disableMobilePadding:!0,topBorder:t.isMobile,style:{borderBottom:`1px solid ${this.theme.regularDividerColor}`}})),items:this.getSpaceMenuListItems(e)}].filter((e=>e.items.length>0))}getSpaceMenuListItems(e){const{singleSpaceToSelect:t}=this.props,{currentUserRootStore:i,currentSpaceStore:o}=x.default.state,a=[],n=be.Z.getSpaceViewStores(this.environment,e);if(!i||!o)return[];if(n.sort(((e,t)=>{var i,o;const a=Number(Boolean(null===(i=e.getSpaceStore())||void 0===i?void 0:i.canAdmin()));return Number(Boolean(null===(o=t.getSpaceStore())||void 0===o?void 0:o.canAdmin()))-a})),t){const s=n.find((e=>e.getSpaceId()===t));if(s){const t=s.getSpaceStore();t&&a.push(this.getGeneratedSpaceMenuListItem({currentSpaceStore:o,currentUserRootStore:i,spaceStoreForSpaceView:t,spaceViewStore:s,userId:e}))}}else for(const s of n){const t=s.getSpaceStore();t&&a.push(this.getGeneratedSpaceMenuListItem({currentSpaceStore:o,currentUserRootStore:i,spaceStoreForSpaceView:t,spaceViewStore:s,userId:e}))}return a}getUnreadCountForOtherSpaces(){return 0}getGeneratedSpaceMenuListItem(e){const{onSpaceClick:t}=this.props,{spaceStoreForSpaceView:i,currentSpaceStore:o,currentUserRootStore:s,userId:r,spaceViewStore:l}=e,d=r===s.id&&i.id===o.id,c=(0,I.rn)(this.environment,i),p=(0,I.Cx)(i);let u;const g=we.Z.getPublicSpaceData(this.environment,i.id);if(g){const e=g.productId?this.props.intl.formatMessage((0,fe.em)(g.subscriptionTier)):this.props.intl.formatMessage("team"===i.getPlanType()?fe.js.teamTrialPlan:fe.js.personalPlan);u=this.props.intl.formatMessage("personal"===i.getPlanType()?fe.js.workspaceSubtitleWithoutMembers:fe.js.workspaceSubtitleWithMembers,{numberOfWorkspaceMembers:this.props.intl.formatNumber(g.memberCount),planType:e})}return{key:l.id,render:e=>n.createElement(ke.Z,K()({},e,{id:l.id,icon:(0,I.Wd)(this.environment,i),title:c,caption:u,isCheck:d,showDragHandle:!1,disabled:p,disableTooltip:!p,tooltipMessage:a()(F.FormattedMessage,{id:"oauthAuthorizationPage.workspaceSwitcher.disabledWorkspace.tooltip",defaultMessage:"This integration can only be added by a member or admin."})})),action:async e=>{let{event:i}=e;this.close(),d||await t({event:i,spaceViewStore:l})}}}}const Pe=(0,F.injectIntl)(Ie);function xe(e){window.__c={n:"OauthAuthorizationTopBar"};const{onSpaceSwitch:t,disableAccountSwitcher:i,singleSpaceToSelect:o}=e,n=function(){const{isMobile:e}=(0,s.Fy)();return(0,l.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",height:60,paddingLeft:20,paddingRight:8,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:p.ZP.contentBorder},notionLogo:{width:e?28:30,height:e?28:30,marginRight:10,flexShrink:0},notionTitle:{fontWeight:y.Z.fontWeight.medium,fontSize:16},switcherButton:{borderRadius:3,marginBottom:0}})),[e])}();return a()("div",{style:n.container},void 0,V.Z.notionLogoStroked(n.notionLogo),a()("div",{style:n.notionTitle},void 0,"Notion"),a()("div",{style:{flexGrow:1,flexShrink:1}}),a()("div",{style:{flexShrink:0}},void 0,a()(Pe,{format:Me._S.Regular,onSpaceClick:e=>{let{spaceViewStore:i}=e;return t(i)},shouldShowUnexpandButton:!1,disableLoginLink:!0,buttonStyle:{borderRadius:3,marginBottom:0},disabled:i,singleSpaceToSelect:o})))}const _e={"929cdebb-09e8-4c5c-bfe5-e8c3c3902987":"development","5dbd3ed0-1160-4532-b10a-1a6749748fc4":"staging"},Ne=["makenotion.com","qasource.com"];function Te(e){window.__c={n:"OauthAuthorization"};const t=e.userId,i=e.spaceId,o=(0,s.O7)(),n=(0,r.VK)((()=>x.default.state.currentUserRootStore),[]),d=(0,r.VK)((()=>x.default.state.currentSpaceStore),[]),c=(0,r.VK)((()=>x.default.state.currentSpaceViewStore),[]),u=(0,r.VK)((()=>{var e;return null===(e=x.default.state.currentUserStore)||void 0===e?void 0:e.getEmail()}),[]),g=(0,r.VK)((()=>!!(t&&i&&c)&&(c.getSpaceId()===i&&c.getUserRootParentId()===t)),[t,i,c]),m=function(e){const{WindowSizeStore:t}=e.environment,i=(0,r.VK)((()=>t.state.width>500),[t]),o=(0,r.VK)((()=>t.state.height<900),[t]);return(0,l.yK)((e=>({layoutContainer:{height:"100%",overflow:"auto",backgroundColor:i?p.ZP.frontCreamBackground:p.ZP.white},pageContainer:{display:"flex",justifyContent:"center"},contentBox:{width:"500px",minHeight:"600px",borderRadius:5,backgroundColor:p.ZP.white,boxShadow:i?e.lightBoxShadow:"none",display:"flex",flexDirection:"column",fontSize:y.Z.fontSize.UIRegular.desktop,marginTop:o?16:i?"calc((100vh - 900px) / 2)":0,marginBottom:40,transition:"all 0.2s ease"},contentBody:{paddingLeft:40,paddingRight:40,paddingTop:25,paddingBottom:25,flex:1,display:"flex",flexDirection:"column"}})),[i,o])}({environment:o});return a()("div",{style:m.layoutContainer},void 0,a()("div",{style:m.pageContainer},void 0,a()("div",{style:m.contentBox},void 0,a()(xe,{disableAccountSwitcher:g,singleSpaceToSelect:i,onSpaceSwitch:async t=>{await A.ce({environment:o,spaceViewStore:t});const i=t.getSpaceId(),a=Ne.find((e=>null==u?void 0:u.endsWith(e)));if(i&&a&&_e[i]&&e.integrationId&&e.redirectUri){const t=(0,M.LH)({baseUrl:(0,M.k2)(_e[i],!1),clientId:e.integrationId,redirectUri:e.redirectUri,state:e.state});S.navigateToExternalURL({environment:o,url:t,targetSelf:!0})}}}),a()("div",{style:m.contentBody},void 0,a()(Ce,{oauthParams:e,spaceStore:d,userRootStore:n})))))}function Ce(e){window.__c={n:"ErrorOrAuthorizationPageWrapper"};const{oauthParams:t,spaceStore:i,userRootStore:o}=e;return i&&o?a()(ze,{oauthParams:t,spaceStore:i,userRootStore:o}):a()(z.Z,{})}function ze(e){window.__c={n:"ErrorOrAuthorizationPage"};const{oauthParams:t,spaceStore:i,userRootStore:o}=e,{integrationId:l,responseType:p}=t,y=(0,s.O7)(),S=(0,r.VK)((()=>I.rn(y,i)),[y,i]),[A,M]=n.useState(),x=(0,r.VK)((()=>{if(l){return(0,_.Kv)(o,{id:l,table:v.K2}).getValue()}}),[l,o]),V=(0,d.V)({value:x,waitTimeInMs:1e3}),[{value:F}]=(0,u.r5)((async()=>{await k.bi(y);const{data:e}=T.default.state;return e?P.NM(e):[]}),[y]),Z=(0,r.VK)((()=>{if(F&&F.length>0){return F.map((e=>{const t=(0,_.Kv)(o,{table:h.cZ,id:e.botId}).getValue();if(t&&t.alive&&(0,c.hA)(t)&&t.created_by_id===o.id&&t.created_by_table===f.KJ&&t.integration_id===l)return{botValue:t,pageIds:e.pageIds}})).filter(b.$K)[0]}}),[F,o,l]),B=(0,r.VK)((()=>{let e={};return Z&&(e=Z.pageIds.reduce(((e,t)=>(e[t]=!0,e)),{})),new C.default(e)}),[Z]),L=(0,r.VK)((()=>{if(!l)return!1;const e=i.getBotSettingsStore().getValue();if(!e)return!0;if((0,w.CJ)(e)){const t=e.integration_approval_statuses;return!(!t||!t[l])&&Boolean("approved"===t[l].status)}return!0}),[l,i]),W=(0,r.VK)((()=>{const e=V.value;if(e)return e.info.template_page_id}),[V]),O=(0,r.VK)((()=>I.Cx(i)),[i]),R=(0,r.VK)((()=>i.canAdmin()),[i]);n.useEffect((()=>{V.value&&!A&&M(x)}),[A,M,x,V]);const K=V.value??A;return"pending"===V.status?a()(z.Z,{}):l&&(0,m.e)(l)?K?"code"!==p?a()(E,{type:"invalidResponseType",oauthParams:t,spaceName:S,integrationValue:K}):O?a()(E,{oauthParams:t,spaceName:S,type:"notAnAdmin",integrationValue:K,primaryAction:()=>{N.Z.setState({...N.Z.state,open:!0})}}):R||L?g._(K,t.redirectUri)?a()(re,{integrationValue:K,validIntegrationTemplateId:W,spaceName:S,spaceId:i.id,oauthParams:t,showApprovalWarning:R&&!L,selectedBlockIdsStore:B}):a()(E,{oauthParams:t,spaceName:S,type:"invalidRedirectUri",integrationValue:K}):a()(E,{oauthParams:t,spaceName:S,type:"integrationNotApproved",integrationValue:K,primaryAction:()=>{N.Z.setState({...N.Z.state,open:!0})}}):a()(E,{type:"clientNotFound",oauthParams:t,spaceName:S}):a()(E,{type:"invalidClientId",oauthParams:t,spaceName:S})}}}]);