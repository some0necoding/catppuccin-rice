"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6395],{47478:(e,i,t)=>{t.d(i,{ZP:()=>G,UV:()=>q,f4:()=>j});var n=t(97464),o=t.n(n),a=t(77094),r=t.n(a),s=t(67294),d=t(24405),l=t(3779),c=t(5366),m=t(97880),u=t(47307),g=t(40394),f=t(42922),p=t(52275),v=t(53695),h=t(64369),y=t(480),w=t(81954),b=t(50906),S=t(54642),M=t(52507),x=t(22346),k=t(13991),D=t(82990),C=t(74194),F=t(68785),I=t(63296);const T=(0,c.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.addNewDomain.samlConfig.subtitle",defaultMessage:"Users with a verified domain can log in {br}using SAML SSO.",description:"Modal subtitle indicating the content is about adding a new domain."},integrationSubtitle:{id:"verifyDomainModal.addNewDomain.integration.subtitle",defaultMessage:"Link preview integrations must verify {br}domains before they are published.",description:"Modal title indicating the content is about adding a new domain."}});const Z=function(e){let{handleAddNewDomain:i,loading:t,verificationType:n}=e;window.__c={n:"AddNewDomain"};const[a,l]=(0,s.useState)(""),u=(0,s.useCallback)((e=>{l(e.target.value)}),[]),g=(0,d.yK)((()=>({title:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},input:{marginTop:22,marginBottom:14}})),[]);let f;switch(n){case"integration":f=T.integrationSubtitle;break;case"saml_config":f=T.samlConfigSubtitle;break;default:(0,m.t1)(n)}return r()(s.Fragment,{},void 0,r()(h.Z,{style:g.title},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.addNewDomain.title",defaultMessage:"Add new domain",description:"Modal title indicating the content is about adding a new domain."})),r()(h.Z,{style:g.subtitle,isMultiline:!0},void 0,s.createElement(c.FormattedMessage,o()({},f,{values:{br:r()("br",{})}}))),r()(C.Z,{value:a,style:g.input,placeholder:"notion.so",onChange:u}),r()(I.Z,{onClick:()=>i(a),style:{width:"100%"},isBlue:Boolean(a),disabled:!Boolean(a)},void 0,t?r()(F.Z,{}):r()(c.FormattedMessage,{id:"verifyDomainModal.addNewDomain.next",defaultMessage:"Next",description:"Text for the next button."})))};const A=function(e){let{domain:i,isExpired:t,onClose:n}=e;window.__c={n:"InvalidDomain"};const o=(0,d.yK)((e=>({title:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);return r()(s.Fragment,{},void 0,r()(h.Z,{style:o.title,isMultiline:!0},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.invalidDomain.title",defaultMessage:"Unable to verify {domain}",description:"Modal title indicating the content is about the domain being invalid.",values:{domain:i}})),r()(h.Z,{style:o.subtitle,isMultiline:!0},void 0,r()(c.FormattedMessage,t?{id:"verifyDomainModal.invalidDomain.expired",defaultMessage:"The code for this domain's verification has expired.",description:"Modal subtitle indicating that the domain is expired."}:{id:"verifyDomainModal.invalidDomain.invalid",defaultMessage:"You are unable to verify this domain because it has already been verified by another workspace.",description:"Modal subtitle indicating that the domain is invalid."})),r()(I.Z,{onClick:n,style:{width:"100%"}},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.invalidDomain.okay",defaultMessage:"Okay",description:"Text for the okay button."})))},B=(0,c.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.verifiedDomain.samlConfig.subtitle",defaultMessage:"Users are able to use this email domain to{br}log in using SAML SSO.",description:"Modal subtitle indicating the content is about verified saml config email domains."},integrationSubtitle:{id:"verifyDomainModal.verifiedDomain.integration.subtitle",defaultMessage:"This integration can unfurl URLs containing this domain.",description:"Modal subtitle indicating link preview integrations can use this domain."}});const V=function(e){let{domain:i,onClose:t,verificationType:n}=e;window.__c={n:"VerifyDomain"};const a=(0,d.yK)((()=>({title:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);let l;switch(n){case"saml_config":l=B.samlConfigSubtitle;break;case"integration":l=B.integrationSubtitle;break;default:(0,m.t1)(n)}return r()(s.Fragment,{},void 0,r()(h.Z,{style:a.title,isMultiline:!0},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.title",defaultMessage:"Successfully verified {domain}",description:"Modal title indicating the content is about adding a new domain.",values:{domain:i}})),r()(h.Z,{style:a.subtitle,isMultiline:!0},void 0,s.createElement(c.FormattedMessage,o()({},l,{values:{br:r()("br",{})}}))),r()(I.Z,{onClick:t,style:{width:"100%"}},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.okay",defaultMessage:"Okay",description:"Text for the okay button."})))};var P=t(63143),R=t(43132),E=t(16402),O=t(64921);const _=function(e){let{handleVerifyDomain:i,domainVerification:t,loading:n}=e;window.__c={n:"VerifyExistingDomain"};const o=(0,y.O7)(),a=t.expiresAt-Date.now()<2*P.U6,m=(0,d.yK)((e=>({title:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},list:{paddingInlineStart:22,margin:"24px 0"},listItem:{fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",marginBottom:12},expiresSoonText:{color:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500]},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:D.Z.getCompositeFontFamily(k.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},code:{width:"100%",color:e.mediumTextColor,fontFamily:D.Z.getCompositeFontFamily(k.SP).mono,fontSize:14,fontWeight:400,lineHeight:"18px"},codeContainer:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:3,marginTop:4,marginBottom:8}})),[]);return r()(s.Fragment,{},void 0,r()(h.Z,{style:m.title},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.title",defaultMessage:"Verify your domain",description:"Modal title indicating the content is about verifying a domain."})),r()(h.Z,{style:m.subtitle},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.subtitle",defaultMessage:"Follow these steps to finalize verification.",description:"Modal subtitle indicating the content is about verifying a domain."})),r()(h.Z,{isSmall:!0,style:{marginTop:22}},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeLabel",defaultMessage:"Verification code",description:"Label for the verification code."})),r()("div",{style:m.codeContainer},void 0,r()(h.Z,{style:m.code},void 0,`notion-domain-verification=${t.verificationCode}`),r()(O.Z,{onClick:function(){R.RD({environment:o,stringValue:`notion-domain-verification=${t.verificationCode}`,copiedMessage:R.tq.copiedLinkToClipboard})},style:m.copyButton},void 0,l.Z.copy(m.copyIcon),r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.copy",defaultMessage:"Copy",description:"Button for copying the content of the verification code."}))),r()(h.Z,{style:a?m.expiresSoonText:void 0,isSmall:!0},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeExpiresAt",defaultMessage:"Expires on {timeLeft}",description:"Label explaining how much time is left before the code expires.",values:{timeLeft:(0,E.gs)(t.expiresAt)}})),r()("ol",{style:m.list},void 0,r()("li",{style:m.listItem},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsDNS",defaultMessage:"Navigate to the DNS record section of your domain host.",description:"An instructional step explaining to navigate to DNS record section of the domain host."})),r()("li",{style:m.listItem},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsTXT",defaultMessage:"Create a new TXT record and paste in the code above as the value.",description:"An instructional step explaining to use the code we provide for the TXT record."})),r()("li",{style:m.listItem},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsHangTight",defaultMessage:"Typically, this change takes only minutes to occur, however, there are cases where it may take up to 72 hours for the DNS record to propagate.",description:"An instructional step explaining that DNS changes can take time to reflect changes."})),r()("li",{style:m.listItem},void 0,r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsVerify",defaultMessage:'Click "Verify" to notify Notion to check your DNS record.',description:"An instructional step explaining to click the verify button when the changes have been reflected."}))),r()(I.Z,{style:{width:"100%"},onClick:()=>i(t),disabled:n},void 0,n?r()(F.Z,{}):r()(c.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verify",defaultMessage:"Verify",description:"Text for the verify button."})))};const W=function(e){window.__c={n:"VerifyDomainModal"};const i=(0,y.O7)(),t=(0,d.Fg)(),[n,o]=(0,w.AF)(e.store,M.ZP),{verificationType:a,verificationTargetId:l,refreshDomains:c}=e,g=(0,s.useCallback)((()=>{o((e=>({...e,loading:!1,modalOpen:!1})))}),[o]),f=(0,s.useCallback)((async e=>{o((e=>({...e,loading:!0})));const t="integration"===a?{type:a,integrationId:l,domain:e}:{type:a,spaceId:l,domain:e},n=await S.createDomainVerificationCode(i,t);if("success"===n.type){c(),b.trackAddDomainVerification(i,{type:a});const e=n.data.domainVerification,t=(0,M.Hs)(e);o((e=>({...e,domainVerification:t,loading:!1})))}else u.showErrorMessage(n.error.message),o((e=>({...e,loading:!1})))}),[i,o,l,c,a]),p=(0,s.useCallback)((async e=>{o((e=>({...e,loading:!0})));const t=await S.verifyDomain(i,{verificationId:e.id});if(b.trackDomainVerificationAttempt(i,{type:a}),"success"===t.type){c(),b.trackDomainVerificationSuccess(i,{type:a});const t={type:"verified",domain:e.domain};o((e=>({...e,domainVerification:t,loading:!1})))}else u.showErrorMessage(t.error.message),o((e=>({...e,loading:!1})))}),[i,o,c,a]),v=(0,s.useCallback)((()=>{if(!n.domainVerification)return r()(Z,{handleAddNewDomain:f,loading:n.loading,verificationType:a});switch(n.domainVerification.type){case"invalid":return r()(A,{domain:n.domainVerification.domain,isExpired:Date.now()>n.domainVerification.expiresAt,onClose:g});case"unverified":return r()(_,{handleVerifyDomain:p,domainVerification:n.domainVerification,loading:n.loading});case"verified":return r()(V,{domain:n.domainVerification.domain,onClose:g,verificationType:a});default:(0,m.t1)(n.domainVerification)}}),[n.domainVerification,n.loading,p,f,g,a]);return r()(x.Z,{open:n.modalOpen,onDismiss:g,render:()=>r()("div",{style:{background:t.popoverBackground,width:410,padding:24,borderRadius:3}},void 0,v())})};var z=t(5478);const H=[{id:"domain",headerTitle:r()(c.FormattedMessage,{id:"domainVerificationTable.table.header.domain",defaultMessage:"Domain",description:"Header for the domain column in the verified domains table."}),renderCell:e=>r()(h.Z,{},void 0,e.domain),widthData:{width:100},sortable:!1},{id:"status",headerTitle:r()(c.FormattedMessage,{id:"domainVerificationTable.table.header.status",defaultMessage:"Status",description:"Header for the status column in the verified domains table."}),renderCell:e=>r()(K,{status:e.status}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:null,renderCell:e=>r()(Y,{onShowDetails:e.onShowDetails,onRemove:e.onRemove}),widthData:{width:20},sortable:!1}],L=(0,c.defineMessages)({verifiedSAMLWarning:{defaultMessage:"Deleting this domain will prevent others with this email from logging in using SAML SSO.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.description",description:"Description about what will happen when you delete a SAML SSO domain."},verifiedIntegrationsWarning:{defaultMessage:"Deleting this domain will prevent integrations from unfurling urls that contain this domain.",id:"domainVerificationInput.myIntegrations.emailDomainsSection.removeDomain.description",description:"Description about what will happen when you delete an unfurling integration domain."},unverifiedDomainWarning:{defaultMessage:"Deleting this domain will restart its verification process. A new verification code will be generated for this domain in the next verification attempt.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.pending.description",description:"Description about what will happen when you delete a SAML SSO domain."}}),U={fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},N={fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"};function K(e){let{status:i}=e;window.__c={n:"VerificationToken"};const t=(0,d.yK)((e=>{const t={[z.YF.Success]:e.statusTokenBackground.green,[z.YF.Pending]:e.statusTokenBackground.yellow,[z.YF.Failure]:e.statusTokenBackground.red},n={[z.YF.Success]:e.statusTokenIndicator.green,[z.YF.Pending]:e.statusTokenIndicator.yellow,[z.YF.Failure]:e.statusTokenIndicator.red},o={[z.YF.Success]:e.statusTokenText.green,[z.YF.Pending]:e.statusTokenText.yellow,[z.YF.Failure]:e.statusTokenText.red};return{container:{background:t[i],color:o[i],display:"flex",justifyContent:"center",alignItems:"center",gap:6,borderRadius:18,height:20,paddingLeft:7,paddingRight:9},dot:{background:n[i],width:10,height:10,borderRadius:"100%"}}}),[i]);return r()("div",{style:t.container},void 0,r()("div",{style:t.dot}),function(e){switch(e){case z.YF.Success:return r()(c.FormattedMessage,{defaultMessage:"Verified",id:"domainVerificationInput.emailDomainsSection.statusToken.verified",description:"Shown in a tooltip when hovering over a verified domain."});case z.YF.Pending:return r()(c.FormattedMessage,{defaultMessage:"Pending",id:"domainVerificationInput.emailDomainsSection.statusToken.pending",description:"Shown in a tooltip when hovering over a pending domain."});case z.YF.Failure:return r()(c.FormattedMessage,{defaultMessage:"Failed",id:"domainVerificationInput.emailDomainsSection.statusToken.failed",description:"Shown in a tooltip when hovering over a failed domain."});default:(0,m.t1)(e)}}(i))}function Y(e){let{onShowDetails:i,onRemove:t}=e;const n=(0,d.yK)((e=>({primaryIcon:{width:14,height:14,color:e.mediumIconColor,fill:"currentColor"},menuItem:{width:250},menuIcon:{width:14,height:14,color:e.regularIconColor,fill:"currentColor"}})),[]),a=[];return i&&a.push({key:"details",action:()=>i(),render:e=>s.createElement(p.Z,o()({},e,{style:n.menuItem,focused:!1,icon:l.Z.info(n.menuIcon),title:r()(c.FormattedMessage,{defaultMessage:"View details",id:"securitySAMLSettings.emailDomainsSection.details",description:"Button for showing the details of a domain verification record."}),caption:r()(c.FormattedMessage,{defaultMessage:"See more information about the state of this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.detailsCaption",description:"Caption for the button that shows the details of a domain verification record."}),shouldWrapCaption:!0}))}),t&&a.push({key:"remove",action:()=>t(),render:e=>s.createElement(p.Z,o()({},e,{style:n.menuItem,focused:!1,icon:l.Z.trash(n.menuIcon),title:r()(c.FormattedMessage,{defaultMessage:"Remove domain",id:"securitySAMLSettings.emailDomainsSection.remove",description:"Button for removing a domain verification record."}),caption:r()(c.FormattedMessage,{defaultMessage:"Delete this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.removeCaption",description:"Caption for the button that removes of a domain verification record."}),shouldWrapCaption:!0}))}),0===a.length?null:r()(v.N,{hideDropdownIcon:!0,title:l.Z.dots(n.primaryIcon),items:a})}function j(e){return{domain:e,status:z.YF.Success,data:{type:"verified",domain:e}}}function q(e){return Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:z.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:z.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}}const G=function(e){window.__c={n:"DomainVerificationTable"};const{disabled:i,domains:t,domainVerificationStore:n,verificationType:o,verificationTargetId:a,refreshDomains:l,onRemoveDomain:p,onClickAddDomain:v,renderOverrideAddDomainButton:y}=e,w=(0,d.yK)((e=>(0,g.b)({columnRenderInfo:H,theme:e,containerMarginTop:0})),[]);function b(){i||(v&&v(),n.setState({domainVerification:void 0,loading:!1,modalOpen:!0}))}const S=t.map((e=>{let{domain:t,status:a,data:d}=e;return{id:"verified"===d.type?t:d.id,isClickable:!1,domain:t,status:a,onShowDetails:i?void 0:()=>function(e){i||n.setState({domainVerification:e,loading:!1,modalOpen:!0})}(d),onRemove:i?void 0:()=>async function(e,i){let t;if(i===z.YF.Failure)return void p(e);i===z.YF.Pending?t=L.unverifiedDomainWarning:i===z.YF.Success?t="saml_config"===o?L.verifiedSAMLWarning:L.verifiedIntegrationsWarning:(0,m.t1)(i),await u.confirmUserAction({message:r()("div",{style:U},void 0,r()(c.FormattedMessage,{defaultMessage:"Are you sure you want to delete this domain?",id:"domainVerificationInput.emailDomainsSection.removeDomain.message",description:"Title asking the user if they are sure they want to delete this domain."})),description:r()("div",{style:N},void 0,s.createElement(c.FormattedMessage,t)),acceptLabel:r()(c.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.accept",defaultMessage:"Delete domain",description:"Button for accepting the delete domain workflow."}),cancelLabel:r()(c.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.cancel",defaultMessage:"Cancel",description:"Button for canceling the delete domain workflow."})})&&p(e)}(d,a)}}));return r()(s.Fragment,{},void 0,y?y(b):r()(f.Z,{isLarge:!0,disabled:i,onClick:b,style:{margin:"4px 0px 16px",width:"fit-content"}},void 0,r()(c.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain",description:"Button for adding a new domain verification record."})),r()(g.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:H,rows:S,styles:w,renderNoRowsComponent:()=>r()(h.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"}},void 0,r()(c.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emptyTable",defaultMessage:"No domains configured.",description:"Message displayed on the table that shows verified domains if there are no domains to show."}))}),r()(W,{store:n,verificationTargetId:a,verificationType:o,refreshDomains:l}))}},27830:(e,i,t)=>{t.d(i,{s:()=>se,D:()=>ge});var n=t(97464),o=t.n(n),a=t(77094),r=t.n(a),s=t(96486),d=t.n(s),l=t(67294),c=t(1302),m=t(480),u=t(81954),g=t(24405),f=t(1800),p=t(78601),v=t(66673),h=t(3779),y=t(64572),w=t(76725),b=t(61784),S=t(80984),M=t(21202),x=t(70279),k=t(70203),D=t(44805),C=t(82990),F=t(44876),I=t(5366),T=t(43132),Z=t(45990),A=t(993),B=t(25103),V=t(30149),P=t(761),R=t(95477),E=t(17731),O=t(73744),_=t(41232),W=t(6398),z=t(88804),H=t(25464),L=t(15723),U=t(79315),N=t(96049),K=t(42653),Y=t(3815),j=t(48588),q=t(93405),G=t(64921),$=t(31945),X=t(51077),J=t(73063),Q=t(71669),ee=t(44532),ie=t(76798),te=t(27186),ne=t(40662),oe=t(69255),ae=t(25735),re=t(29551);function se(e){window.__c={n:"HoverPreviewOverlay"};const i=(0,u.Kw)(N.Z,{debugName:"HoverPreviewOverlay"}),{state:t,pinPopup:n,unpinPopup:o,hasBeenHovering:a,isPinned:s}=function(){const[e]=(0,u.AF)(j.Z),i=(0,v.Kt)(e,400,Object.is),[t,n]=(0,l.useState)(void 0),o=t||i,a=(0,l.useCallback)((()=>n(o)),[o]),r=(0,l.useCallback)((()=>{n(void 0)}),[]);return{state:o,pinPopup:a,unpinPopup:r,hasBeenHovering:e&&e===o,isPinned:Boolean(t)}}(),d=function(e){const i=(0,m.O7)();return(0,u.VK)((()=>!!e&&(0,z.E)(i,e.store)),[e,i])}(t),c=(0,l.useMemo)((()=>Boolean(t&&function(e,i){return i&&(e.annotations.some(k.j0)||e.annotations.some(k.nS))}(t,d))),[t,d]),g=!!c||Boolean(!i&&a),f=(0,l.useMemo)((()=>t&&t.token.node.getBoundingClientRect()),[t]),[,p]=(0,u.AF)(K.Z);(0,l.useEffect)((()=>(p({isPinned:s}),()=>p({isPinned:!1}))),[s,p]);const h=!(null!=t&&t.annotations.some(k.nS));return r()(ee.ZP,{disableMouseCapture:!0,preventCaptureEsc:!0,preventPointerEvents:!c,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:ee.ZP.PopupType.Popup,open:g,originRect:f,originGap:8,alignmentToOrigin:ee.ZP.Alignment.Start,placementToOrigin:ee.ZP.Placement.Bottom,useLightBoxShadow:h,render:()=>t&&r()("div",{onMouseEnter:n,onMouseLeave:o},void 0,r()(de,{state:t,isHoveredTokenEditable:d,onDismiss:o}))})}function de(e){(0,l.useEffect)((()=>{const e=d().throttle(B.l,200,{leading:!0});return O.lj(window,"scroll",e,!0),()=>O.ZV(window,"scroll",e,!0)}),[]);const i=(0,m.Fy)(),t=(0,u.VK)((()=>{const{currentSpaceStore:e}=U.default.state;return e?e.getPermissionGroups():[]}),[]),n=(0,g.yK)((e=>({noMembersInGroupStyle:{fontSize:C.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}})),[]),a=e.state.annotations,s=a.find(k.j0),c=a.find(k.fp),f=a.find(k._b),p=a.find(k.aq),v=k.fr(a);if(s&&e.state.store.table!==x.x_)return l.createElement(le,o()({},e,{state:{...e.state,annotation:s}}));if(c)return l.createElement(ce,o()({},e,{state:{...e.state,annotation:c}}));if(f){const e=k.kx(f);if(e){const i=e.groupId,o=t.find((e=>e.id===i));if(o)return r()(ae.Y,{group:o,limit:10,color:"white_background",trackHover:!0,noMembersMessage:r()(re.gq,{style:n.noMembersInGroupStyle},void 0,r()("div",{style:C.Z.textOverflowStyle},void 0,r()(I.FormattedMessage,{id:"groupPreview.noUsers",defaultMessage:"No users in this group",description:"Tooltip text that shows when a user hovers over a mentioned group that does not have any members in it"})))})}}return p?l.createElement(me,o()({},e,{state:{...e.state,annotation:p}})):v&&!i.isMobile?l.createElement(ge,o()({},e,{state:{...e.state,annotation:v},onDismiss:e.onDismiss})):null}function le(e){window.__c={n:"HoverLinkPreviewOverlayRenderer"};const{onDismiss:i}=e,{annotation:t,store:n,token:o}=e.state,a=(0,m.O7)(),s=(0,g.Fg)(),d=k.zW(t),p=(0,y.A5)({url:d,baseUrl:R.Z.domainBaseUrl,publicDomainName:R.Z.publicDomainName}),v=(0,l.useCallback)((async()=>{i(),A.AE({token:o,store:n,readOnly:!1}),await c.default.afterNextFlush(),Z.dz({type:"focusOnly",focus:!0})}),[i,n,o]),w=(0,l.useCallback)((async()=>{i(),await c.default.afterNextFlush();const e=T.tq.copiedLinkToClipboard;let t=d;const o=(0,S.Wj)({url:d,baseUrl:R.Z.domainBaseUrl,publicDomainName:R.Z.publicDomainName,isMobile:a.device.isMobile,protocol:R.Z.protocol,currentUrl:window.location.href});if("page"===o.name){const e=Y.G.createChildStore(n,{table:M.iU,id:o.blockId});t=(0,f.Z)({pageId:o.blockId,pageModel:e.getModel(),baseUrl:R.Z.domainBaseUrl,discussionId:o.discussionId,scrollToBlockId:o.scrollToBlockId,peekViewBlockId:o.peekViewBlockId,peekMode:o.peekMode})}T.RD({environment:a,stringValue:t,copiedMessage:e})}),[a,i,n,d]),b=(0,g.yK)((e=>({wrapper:{fontSize:C.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:C.Z.fontWeight.regular,fill:e.mediumIconColor},destination:{padding:"4px 0 4px 6px"},button:{display:"flex",alignItems:"center",padding:"2px 6px",whiteSpace:"nowrap",marginRight:2,borderRadius:3,color:e.regularTextColor},destinationText:{paddingRight:6,maxWidth:250,...C.Z.textOverflowStyle},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}})),[]),x=(0,u.VK)((()=>{if(!p)return;const e=Y.G.createChildStore(n,{table:M.iU,id:p});return{pageIcon:(0,D.tp)({pageModel:e.getModel(),pageRole:e.getRole(),baseUrl:R.Z.domainBaseUrl,getRecordModel:n.getRecordModel,emojiType:(0,E.e)(a),isSafariOrIOS:a.device.isSafari||a.device.isIOS,isClient:!0,showEmojiInline:a.device.isWindows,currentUserId:a.currentUser.id,theme:s}),title:r()(ie.Z,{style:b.destinationText,store:e})}}),[a,n,p,b,s])||{pageIcon:h.Z.globe2(b.icon),title:r()("div",{style:b.destinationText},void 0,d)};return r()(re.gq,{style:b.wrapper,alignItems:"center"},void 0,r()(re.gq,{style:b.destination,alignItems:"center"},void 0,x.pageIcon,x.title),r()(J.Z,{onClick:w,icon:h.Z.copy,isDarkIconColor:!0}),e.isHoveredTokenEditable&&r()(G.Z,{style:b.button,onClick:v},void 0,r()(I.FormattedMessage,{defaultMessage:"Edit",id:"hoverPreviewOverlay.editButton.label"})))}function ce(e){window.__c={n:"HoverDatePreviewOverlayRenderer"};const{annotation:i}=e.state,t=k.Ot(i),n=(0,g.yK)((e=>({container:{fontSize:C.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"},icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor}})),[]),o=(0,I.useIntl)(),a="relative"===t.date_format?"ll":"relative",s=(0,b.ZV)({value:t,date_format:a,time_format:"h:mm A",allowRelativeDates:!0,intl:o});return s===(0,b.ZV)({value:t,date_format:t.date_format,time_format:t.time_format,allowRelativeDates:!0,intl:o})?null:r()(re.gq,{style:n.container,alignItems:"center"},void 0,h.Z.calendar(n.icon),r()("div",{style:C.Z.textOverflowStyle},void 0,s))}function me(e){window.__c={n:"HoverTemplateVariablePreviewOverlayRenderer"};const{annotation:i}=e.state,t=k.fs(i),n=(0,I.useIntl)(),o=k.Z0(t.type,n),a=(0,g.yK)((e=>({container:{fontSize:C.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,padding:"4px 8px"}})),[]);return r()(re.gq,{style:a.container,alignItems:"center"},void 0,r()("div",{style:C.Z.textOverflowStyle},void 0,o))}function ue(e){var i;const{renderConfig:t,store:n}=e,a=(0,g.yK)((e=>({title:{color:e.regularTextColor,fontWeight:C.Z.fontWeight.medium,whiteSpace:"initial"},header:{color:e.mediumTextColor,fontSize:C.Z.fontSize.UISmall.desktop},dictionaryKey:{color:e.mediumTextColor,fontWeight:C.Z.fontWeight.regular,fontSize:C.Z.fontSize.UISmall.desktop},dictionaryValue:{color:e.regularTextColor,fontSize:C.Z.fontSize.UIRegular.desktop,whiteSpace:"normal",wordBreak:"break-word"}})),[]);return l.createElement(l.Fragment,null,t.title&&r()(re.gq,{},void 0,l.createElement(W.ox,o()({},t.title,{store:n,style:a.title}))),t.headerAttributes&&t.headerAttributes.length>0&&r()(re.gq,{alignItems:"center",style:{...a.header,marginBottom:3}},void 0,(0,w.Z)(t.headerAttributes.map(((e,i)=>l.createElement(W.ox,o()({key:`attribute-${i}`},e,{store:n,style:{...a.header,...C.Z.textOverflowStyle}}))))||[],(e=>r()("span",{},`dot-${e}`," ","·"," ")))),t.dictionaryAttributes&&t.dictionaryAttributes.length>0&&r()(re.Ht,{},void 0,t.dictionaryAttributes.map(((e,i)=>{var s;let{key:d,value:c}=e;return r()(re.gq,{style:{marginBottom:i!==((null===(s=t.dictionaryAttributes)||void 0===s?void 0:s.length)??0)-1?3:0}},i,r()("div",{style:{marginRight:10,width:"30%",display:"flex",alignItems:"center"}},void 0,r()("span",{style:a.dictionaryKey},void 0,l.createElement(I.FormattedMessage,o()({},d.formatter,{values:{value:c.attribute.name}})))),r()("div",{style:{width:"70%",display:"flex",alignItems:"center"}},void 0,c.icon&&(0,F.li)(c.icon)&&r()(X.Z,{type:"image_url",imageURL:c.icon.values[0],size:16,style:{marginRight:4}}),l.createElement(W.ox,o()({},c,{store:n,style:a.dictionaryValue,avatarStyle:{marginRight:4}}))))}))),t.bodyAttribute&&r()(re.gq,{style:((null===(i=t.dictionaryAttributes)||void 0===i?void 0:i.length)??0)>0?{marginTop:3}:{}},void 0,r()(W.hx,{attribute:t.bodyAttribute})),t.previewImageAttribute&&r()("div",{style:{marginTop:t.dictionaryAttributes?6:0,marginBottom:4,display:"flex",justifyContent:"center"}},void 0,r()("div",{},void 0,r()(Q.Z,{src:t.previewImageAttribute.values[0],style:{width:"100%",maxHeight:250}}))))}function ge(e){const{state:{annotation:i,store:t,token:n},onDismiss:a}=e,s=k.Ik(i),d=(0,m.O7)(),c=(0,g.Fg)(),f=(0,l.useRef)(null),v=(0,u.VK)((()=>{const i=Y.G.createChildStore(t,{table:M.iU,id:s,spaceId:t.pointer.spaceId}),m=i.canEdit(),u=(0,_._F)({store:i,isInDarkMode:"dark"===c.mode,canEdit:m,currentUserId:d.currentUser.id,getRenderFn:e=>i=>{var t,n;return(null===(t=e.hover)||void 0===t?void 0:t.call(e,i))||(null===(n=p.j.hover)||void 0===n?void 0:n.call(p.j,i))},showAction:void 0});if(!u)return;const{renderConfig:g,integration:v}=u,y=Boolean(u.action),w=e.isHoveredTokenEditable,b=t.recordStoreUIParentStore&&t.recordStoreUIParentStore instanceof Y.G?t.recordStoreUIParentStore:void 0,S={key:"turn preview into block",render:e=>l.createElement(q.Z,o()({},e,{title:r()(I.FormattedMessage,{id:"hoverPreviewOverlay.action.turnPreviewIntoPreview",defaultMessage:"Turn into preview",description:"Menu option to convert an inline mention into a link preview"}),svg:h.Z.loop})),action:()=>{b&&n&&V.createAndCommit({userAction:"HoverPreviewOverlay.transformExternalObjectInstanceMentionIntoBlock",environment:d,perform:e=>{P.aV({block:i,parentStore:b,transaction:e,token:n}),e.postSubmitCallbacks.push((e=>{e||null==a||a()}))}})}},x=[];return i.isExternalObjectInstanceBlockStore()&&x.push(S),l.createElement("div",{style:{display:"flex",flexDirection:"column"},ref:f},r()(re.gq,{alignItems:"center",style:{fontSize:12}},void 0,r()(X.Z,{type:"image_url",imageURL:v.icon,size:16,style:{marginRight:"4px"}}),r()("div",{style:{flexGrow:1,fontWeight:C.Z.fontWeight.medium}},void 0,v.name),n&&!y&&w&&r()("div",{},void 0,r()($.Z,{popupType:$.Z.PopupType.Popup,placementToOrigin:H.u.Right,alignmentToOrigin:H.v.Start,originGap:4,onClose:()=>{let e=!1;const i=f.current;i&&(e=(0,L.uh)(i.getBoundingClientRect(),te.IL.x,te.IL.y)),e||null==a||a()},renderOrigin:e=>l.createElement(G.Z,o()({style:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:3}},e),h.Z.dots({width:14})),render:e=>r()(oe.Z,{titleForReloadMenuOption:r()(I.FormattedMessage,{id:"linkMention.reload",defaultMessage:"Reload mention",description:"Menu option to reload inline link mention"}),store:i,onAccept:()=>e.close(),extraSecondaryItems:x})}))),y&&w?r()("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",margin:"6px 0"}},void 0,r()(ne.Z,{canEdit:m,store:i,isHoverPreview:!0,postActionCallback:a})):r()(ue,{renderConfig:g,store:i}))}),[s,t,d,c,n,a,e.isHoveredTokenEditable,f]);return v?r()("div",{style:{padding:"8px 16px",minWidth:300,maxWidth:350}},void 0,v):null}},5478:(e,i,t)=>{t.d(i,{YF:()=>u,ZP:()=>f});var n=t(97464),o=t.n(n),a=t(77094),r=t.n(a),s=t(67294),d=t(24405),l=t(25464),c=t(58032),m=t(85567);const u={Success:"success",Pending:"pending",Failure:"failure"};const g={display:"flex",justifyContent:"center",alignItems:"baseline"},f=function(e){let{status:i,value:t,renderTooltip:n,...a}=e;window.__c={n:"StatusToken"};const f=(0,d.Fg)(),p={[u.Success]:f.statusTokenBackground.green,[u.Pending]:f.statusTokenBackground.yellow,[u.Failure]:f.statusTokenBackground.red},v={[u.Success]:f.statusTokenIndicator.green,[u.Pending]:f.statusTokenIndicator.yellow,[u.Failure]:f.statusTokenIndicator.red},h={[u.Success]:f.statusTokenText.green,[u.Pending]:f.statusTokenText.yellow,[u.Failure]:f.statusTokenText.red};return n?s.createElement(m.Z,o()({},a,{backgroundColor:p[i],color:h[i],value:r()(c.Z,{placement:l.u.Bottom,alignment:l.v.Start,renderTooltip:n,render:e=>s.createElement("div",o()({style:g},e),r()("div",{style:{background:v[i],width:8,height:8,borderRadius:"100%",marginRight:4}}),t)})})):s.createElement(m.Z,o()({},a,{backgroundColor:p[i],color:h[i],value:r()("div",{style:g},void 0,r()("div",{style:{background:v[i],width:8,height:8,borderRadius:"100%",marginRight:4}}),t)}))}},719:(e,i,t)=>{t.d(i,{Z:()=>u});var n=t(97464),o=t.n(n),a=t(77094),r=t.n(a),s=t(67294),d=t(83355),l=t(98742),c=t(74194);class m extends d.Z{constructor(){super(...arguments),this.handleKeyDown=e=>{"Backspace"===e.key&&0===this.props.value.length&&this.props.onRemoveLastToken()}}renderComponent(){const{device:e}=this.environment;return r()("div",{className:this.props.readOnly?void 0:"notion-focusable-within",onClick:this.props.onClick,style:e.isMobile?this.getMobileWrapStyle():this.getDesktopWrapStyle()},void 0,this.props.tokens,this.renderInput())}renderInput(){const{device:e}=this.environment,i=0===this.props.tokens.length;return s.createElement(c.Z,o()({format:c.Z.Format.Transparent},(0,l.Z)({onKeyDown:this.handleKeyDown},{onChange:this.props.onChange}),{value:this.props.value,onSubmit:this.props.onSubmit,onBlur:this.props.onBlur,focus:this.props.focus,style:{...m.inputStyle,margin:e.isMobile?"0 8px 8px 0":"0 6px 6px 0"},readOnly:this.props.readOnly,inputStyle:{height:18},size:1,type:this.props.type,placeholder:i?this.props.placeholder:"",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1}))}getDesktopWrapStyle(){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",minHeight:32,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,borderRadius:3,fontSize:14,cursor:"text",overflow:"hidden",padding:"7px 9px 0px",...this.props.style}}getMobileWrapStyle(){return{...this.getDesktopWrapStyle(),fontSize:14,padding:"7px 10px 0"}}}m.displayName="TokenInput",m.inputStyle={flexGrow:1,flexShrink:1,flexBasis:60,minWidth:60,width:"auto",lineHeight:"20px"};const u=m},52507:(e,i,t)=>{t.d(i,{AS:()=>r,Hs:()=>s,ZP:()=>d});var n=t(49085),o=t(97880);class a extends n.Z{getInitialState(){return{modalOpen:!1,loading:!1,domainVerification:void 0}}}const r=(0,o.AO)((e=>"invalid"===e.type||"unverified"===e.type?{true:e}:{false:e}));function s(e){return{type:e.verified_at?"verified":"unverified",id:e.id,domain:e.domain,verificationCode:e.verification_code,createdAt:e.created_at,expiresAt:e.expires_at,invalidatedAt:e.info.invalidated_at}}const d=a}}]);