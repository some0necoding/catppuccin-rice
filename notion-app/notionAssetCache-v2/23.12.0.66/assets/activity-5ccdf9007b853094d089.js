"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1471],{48298:(e,t,i)=>{i.d(t,{kn:()=>p,kj:()=>g,Tr:()=>m});var o=i(58129),r=i(90468),n=i(19889),a=i(50906),s=i(54642),d=i(10279),c=i(9953),l=i(30149),h=i(3815),u=i(98905);const p=async e=>{const{environment:t,store:i,accessRequestStore:o,forActor:r,status:s,from:h}=e,u=t.currentUser.id;if("approved"===s){const e={type:"existingUser",value:r,spaceRole:"read_and_write"};if(!(await d.n_({environment:t,store:i,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}l.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{c.sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:n.KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:n.KJ,resolved_by_id:u,status:s}})}}),a.trackResolveMembershipRequest(t,{status:s,request_id:o.id,from:h,for_actor_id:r.id,space_role:i.getRole()})};async function g(e){if(u.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await s.getUnreadAccessRequestCount(t,{parentTable:r.bx,parentId:i,size:1});"success"===o.type&&u.Z.setState({spaceId:i,count:o.data.count})}function m(e,t){const i=new Map;for(const r of t){const t=(0,h.Kv)(e,{table:o.J8,id:r}),a=t.getValue();if(!a)continue;if(a.for_actor_table!==n.KJ||a.created_by_table!==n.KJ)continue;const s=(0,h.Kv)(e,{table:a.for_actor_table,id:a.for_actor_id}).getValue();if(!s)continue;const d=(0,h.Kv)(e,{table:a.created_by_table,id:a.created_by_id}).getValue();if(d)if(i.has(a.for_actor_id)){const e=i.get(a.for_actor_id);if(!e)continue;a.created_time>e.latestRequestTime?i.set(a.for_actor_id,{...e,createdByActorsWithReason:[{actor:d,reason:a.message},...e.createdByActorsWithReason],accessRequest:a,accessRequestStore:t,latestRequestTime:a.created_time}):i.set(a.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:d,reason:a.message}]})}else i.set(a.for_actor_id,{forActor:s,createdByActorsWithReason:[{actor:d,reason:a.message}],accessRequest:a,accessRequestStore:t,latestRequestTime:a.created_time})}return Array.from(i.values())}},51897:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Xt});var o=i(97464),r=i.n(o),n=i(77094),a=i.n(n),s=i(96486),d=i.n(s),c=i(67294),l=i(83355),h=i(40902),u=i(66897),p=i(15145),g=i(82813),m=i(41432),v=i(80951),f=i(39068),b=i(59753),y=i(55061),S=i(89101),A=i(58129),k=i(21202),M=i(77420),_=i(6287),T=i(13493),w=i(70279),R=i(33709),O=i(84683),C=i(90468),B=i(29369),I=i(19889),J=i(94044),D=i(99108),N=i(97880),P=i(82990),x=i(64002),Z=i(63143),L=i(5366),U=i(50906),V=i(19719),E=i(17659),F=i(57688),q=i(30149),K=i(51456),G=i(4708),W=i(33929),H=i(67669),z=i(16402),$=i(3815),j=i(62820),Y=i(4761),X=i(480),Q=i(81954),ee=i(8848),te=(i(41892),i(3779)),ie=i(24211),oe=i(61784),re=i(76725),ne=i(63306);class ae extends c.PureComponent{render(){const{href:e}=this.props;return a()("a",{href:(0,x.Nm)({str:e,allowNoProtocol:!0}),style:this.getStyle(),className:"notion-email-button-hover"},void 0,this.props.children)}getStyle(){return{display:this.props.inline?"inline":"block",color:ee.ZP.inherit,textDecoration:"none",cursor:"pointer",...this.props.style}}}const se=ae;class de extends c.PureComponent{render(){const e=this.getPathWithoutDomain();return e.length>0?a()("div",{},void 0,this.props.left,(0,re.Z)(e,(e=>a()("span",{style:{paddingLeft:4,paddingRight:4}},`slash:${e}`,"/"))),this.props.right):null}getPathWithoutDomain(){const{getRecordValue:e,blockId:t,intl:i}=this.props,o=ne.uJ({table:"block",id:t},e),r=b.om.fromGetRecordValueFn(e);return d().initial(o.reverse()).map((e=>{const t=b.kk.fromBlock(e),o=t.getRenderTitle({getRecordModel:r,userTimeZone:this.props.userTimeZone,intl:i})||i.formatMessage({id:"recordPath.untitledBlock.placeholder",defaultMessage:"Untitled"}),n=t.getRenderUrl({getRecordModel:r});return a()(se,{href:`${this.props.baseUrl}${n}`,style:{display:"inline-block",maxWidth:120,verticalAlign:"top",...P.Z.textOverflowStyle}},e.id,o)}))}}const ce=(0,L.injectIntl)(de);i(43593),i(17755),i(58102);c.PureComponent;class le extends c.PureComponent{constructor(){super(...arguments),this.theme=(0,ee.gh)({theme:"light"})}render(){const{children:e}=this.props;return a()("table",{style:{paddingTop:12,paddingBottom:e?0:8,borderSpacing:0,width:"100%",borderCollapse:"separate"}},void 0,a()("tr",{},void 0,a()("td",{style:{verticalAlign:"top",width:le.avatarSize+6,minWidth:le.avatarSize+6,paddingTop:2}},void 0,this.props.icon),a()("td",{},void 0,this.renderHeader())),a()("tr",{},void 0,a()("td",{}),a()("td",{style:{maxWidth:400}},void 0,e&&this.renderChildren())),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return a()("tr",{},void 0,a()("td",{colSpan:2},void 0,a()("div",{style:this.getBorderBottomStyle()})))}renderHeader(){const{timestamp:e,header:t,intl:i}=this.props,o=(0,oe.Yx)(Math.min(e,Date.now()),"medium_with_time",(0,ie.E2)(i),this.props.userTimeZone);return a()("div",{style:le.headerStyle},void 0,a()("div",{},void 0,t),a()("table",{style:{...this.getPathAndTimeStyle(),marginTop:4,marginBottom:this.props.children?8:4,borderSpacing:0}},void 0,a()("tr",{},void 0,a()("td",{},void 0,o),a()("td",{},void 0,this.props.navigableBlockId&&a()(ce,{getRecordValue:this.props.getRecordValue,blockId:this.props.navigableBlockId,baseUrl:this.props.baseUrl,left:a()("span",{style:this.getDotStyle()},void 0,"·"),userTimeZone:this.props.userTimeZone})))))}renderChildren(){return a()("div",{},void 0,this.props.children)}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.props.theme.regularDividerColor}`,marginBottom:4}}getPathAndTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getDotStyle(){return{color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}}le.avatarSize=28,le.headerStyle={fontSize:14,lineHeight:1.4};const he={fontWeight:P.Z.fontWeight.semibold};(0,L.injectIntl)(le);var ue=i(51118),pe=i(43250),ge=i(12534),me=i(79315),ve=i(12318),fe=i(73063),be=i(86176),ye=i(58032),Se=i(70301),Ae=i(45653),ke=i(67706),Me=i(24405);function _e(e){let{notification:t,rootStore:i,onArchiveClicked:o,onMarkAsReadClicked:n,onMarkAsUnreadClicked:s}=e;window.__c={n:"InboxActionsMenu"};const d=(0,X.O7)(),l=(0,c.useCallback)((e=>{t&&(0,ge.ZP)({event:e,context:ge.Af.NotificationClick,callback:()=>{o(),q.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:d,perform:e=>{E.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[d,t,o,i]),h=(0,c.useCallback)((e=>{t&&(0,ge.ZP)({event:e,context:ge.Af.NotificationClick,callback:()=>{t.read?s():n(),q.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:d,perform:e=>{E.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[d,t,n,s,i]),{isMobile:u}=d.device,p=(0,Me.yK)((e=>({container:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2},button:{height:u?30:26,width:u?30:26},iconStyle:{fill:e.mediumTextColor,padding:2},readIcon:{width:u?21:19,height:u?22:20},archiveIcon:{width:u?24:23,height:u?24:23}})),[u]);return t?a()("div",{style:p.container},void 0,a()(ye.Z,{renderTooltip:()=>t.read?a()(L.FormattedMessage,{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as unread. The icon is an image of an empty speech bubble."}):a()(L.FormattedMessage,{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as read. The icon is an image of a speech bubble with a checkmark in it."}),render:e=>c.createElement(fe.Z,r()({style:p.button,icon:t.read?te.Z.notificationUnread:te.Z.notificationRead,iconStyle:{...p.iconStyle,...p.readIcon},onClick:h},e))}),a()(ye.Z,{renderTooltip:()=>a()(L.FormattedMessage,{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage",description:"Tooltip message for the icon button to archive a notification. The icon is an image of a storage file box."}),render:e=>c.createElement(fe.Z,r()({style:p.button,icon:te.Z.archive,iconStyle:{...p.iconStyle,...p.archiveIcon},onClick:l},e))})):null}const Te=c.memo(_e);var we=i(32469),Re=i(93963);class Oe extends l.Z{constructor(){super(...arguments),this.storeTypes={hovered:ve.default.of(!1),hoveredOverInboxActionsMenu:ve.default.of(!1)},this.handleMouseOver=()=>{this.stores.hovered.set(!0)},this.handleMouseLeave=()=>{this.stores.hovered.set(!1)},this.handleMouseEnterInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!0)},this.handleMouseLeaveInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!1)},this.handleArchive=()=>{const{notification:e,rootStore:t,onArchiveClicked:i}=this.props;i(),e&&q.createAndCommit({userAction:"ActivitySection.handleArchive",environment:this.environment,perform:i=>{E.aZ({notification:e,rootStore:t,transaction:i})}})},this.handleMarkAsRead=e=>{const{notification:t,rootStore:i,onNotificationFrameClicked:o}=this.props;t&&!t.read&&(this.stores.hoveredOverInboxActionsMenu.get()||(0,ge.ZP)({event:e,context:ge.Af.NotificationClick,callback:()=>{o(),q.createAndCommit({userAction:"ActivitySection.handleMarkAsRead",environment:this.environment,perform:e=>{E.$h({notification:t,rootStore:i,transaction:e,read:!0})}})}}))},this.handleOpenSnapshot=()=>{if(this.props.navigableBlockId){const e=$.G.createChildStore(this.props.rootStore,{table:k.iU,id:this.props.navigableBlockId});ue.jN({environment:this.environment,blockStore:e,openSnapshotNearTimestamp:this.props.timestamp.toString(),from:"activity"})}}}renderComponent(){const{children:e}=this.props,t="mentions"===Y.Z.state.currentTab;return a()("div",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onClick:this.handleMarkAsRead},void 0,this.renderInboxActions(),a()("div",{style:{...Oe.wrapStyle,paddingBottom:e?12:8,paddingLeft:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingLeftCSS:0,paddingRight:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingRightCSS:0,...this.shouldShowReadNotificationStyle()&&{opacity:.7}}},void 0,a()("div",{style:this.getHeaderAndAvatarStyle()},void 0,a()("div",{className:pe.FoE,style:this.avatarAndStatusDotStyle()},void 0,a()("div",{style:{marginRight:4}},void 0,t&&a()("div",{style:{marginRight:this.environment.device.isMobile?3:2}},void 0,this.renderStatusDot({opacity:1}))),this.props.icon),this.renderHeader(),this.renderSnapshotButton(),this.renderPrivate()),e&&this.renderChildren()),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return a()("div",{style:this.getBorderBottomStyle()})}renderHeader(){const{timestamp:e,header:t}=this.props,i=(0,z.IS)(e),o=(0,z.uy)(e);return a()("div",{style:Oe.headerStyle},void 0,a()("div",{className:pe.NFf},void 0,t),a()("div",{style:{display:"flex",marginTop:4,marginBottom:this.props.children?8:4}},void 0,a()("div",{style:this.getTimeStyle(),className:pe.CZG},void 0,a()(ke.Z,{text:i,tooltipText:o,icon:te.Z.calendar})),this.props.navigableBlockId&&this.props.rootStore&&a()(be.Z,{isLink:!0,innerStyle:this.getPathStyle(),store:$.G.createChildStore(this.props.rootStore,{table:k.iU,id:this.props.navigableBlockId}),left:a()("div",{style:this.getSeparatorDotStyle()},void 0,"·"),onClick:this.props.onBacklinkClicked})))}renderSnapshotButton(){if(!this.props.showSnapshotButton)return;if(this.props.timestamp<new Date("2018-10-26").getTime())return;const e=W.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"});return this.props.navigableBlockId?a()(ye.Z,{renderTooltip:()=>e,render:t=>c.createElement(fe.Z,r()({ariaLabel:e,onClick:this.handleOpenSnapshot,icon:te.Z.versionHistoryThick},t))}):void 0}renderInboxActions(){const{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r}=this.props,{currentTab:n}=Y.Z.state;if("mentions"===n&&e&&!e.visited)return a()("div",{style:this.getStatusLabelContainerStyle(),onMouseEnter:this.handleMouseEnterInboxActions,onMouseLeave:this.handleMouseLeaveInboxActions},void 0,a()("div",{style:this.getInboxActionsStyle()},void 0,a()(Te,{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r})))}renderStatusDot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!this.isSeen()&&a()(Re.z,{style:{...this.getStatusDotStyle(),...e}})}renderPrivate(){if(this.props.isPrivate&&!this.props.notification)return a()(we.Z,{style:{marginTop:1,marginBottom:4,marginLeft:8}})}renderChildren(){return a()("div",{className:pe.nU_},void 0,this.props.children)}isSeen(){const{notification:e}=this.props;return!e||e.read}shouldShowReadNotificationStyle(){const{currentTab:e}=Y.Z.state;return this.isSeen()&&"mentions"===e&&!this.props.showSnapshotButton&&this.props.notification}avatarAndStatusDotStyle(){return{display:"flex",alignItems:"flex-start",position:"relative"}}getHeaderAndAvatarStyle(){return{display:"flex",paddingLeft:16,paddingRight:16+("mentions"!==Y.Z.state.currentTab||this.props.showSnapshotButton?0:69)}}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getPathStyle(){return{fontSize:12,color:this.theme.lightTextColor}}getTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getSeparatorDotStyle(){return{fontSize:12,color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}getStatusLabelContainerStyle(){return{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:this.environment.device.isMobile?23:8}}getStatusDotStyle(){return{position:"absolute",opacity:this.stores.hovered.get()?0:1,left:-7,top:10}}getInboxActionsStyle(){const{isMobile:e}=this.environment.device;return{transition:"opacity 100ms ease-out",opacity:e||this.stores.hovered.get()?1:0,position:"absolute",right:16,top:12,zIndex:1}}}Oe.displayName="ActivitySection",Oe.wrapStyle={paddingTop:12},Oe.headerStyle={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0};const Ce={marginTop:2,marginRight:8,flexShrink:0};function Be(e){const{authors:t}=e,i=t[0];return i&&(0,u.z8)(i)?a()(Se.Z,{botValue:i.value,style:Ce,size:24}):a()(Ae.Z,{userValue:i&&i.value,style:Ce,size:24,avatarShouldShowShadow:!0})}function Ie(){return window.__c={n:"ReminderIcon"},a()("div",{style:{display:"flex",backgroundColor:ee.ZP.red,height:28,width:28,borderRadius:"100%",...Ce}},void 0,te.Z.alarmClock({height:16,width:16,fill:ee.ZP.white,marginLeft:6,marginTop:5}))}function Je(){return window.__c={n:"VerificationIcon"},a()("div",{style:{height:25,width:25,...Ce}},void 0,te.Z.typesVerification({height:25,width:25}))}function De(e){const{currentUserStore:t}=me.default.state,i=null==t?void 0:t.id;return function(e,t,i){const o=t.find((e=>e.value.id===i)),r=t.map((t=>(0,u.$4)(e,t)));if(1===t.length)return a()("span",{},void 0,a()(L.FormattedMessage,o?{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label",description:"Bolded string for denoting that the current user generated an activity update notification.",values:{b:e=>a()("span",{style:he},void 0,e)}}:{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",description:"Bolded string for showing the single author that generated an activity update notification.",values:{author:r[0],b:e=>a()("span",{style:he},void 0,e)}}));if(2===t.length){if(o){const i=t.filter((e=>e!==o)).map((t=>(0,u.$4)(e,t)));return a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and you",id:"activitySection.authorPhrase.forTwoAuthorsCurrentUser.label",description:"Bolded string for listing two authors in an activity update notification, with the current user being one of them.",values:{firstAuthor:i[0],b:e=>a()("span",{style:he},void 0,e)}}))}return a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",description:"Bolded string for listing two authors in an activity update notification.",values:{firstAuthor:r[0],secondAuthor:r[1],b:e=>a()("span",{style:he},void 0,e)}}))}if(r.length>2){if(o){const i=t.filter((e=>e!==o)).map((t=>(0,u.$4)(e,t))),r=a()(L.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, =0 {<b>{firstAuthor}</b>, <b>{secondAuthor}</b> and you} one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthorsCurrentUser.label",description:"Bolded string for showing multiple authors that generated an activity update notification, with the current user being one of them.",values:{numberOfOtherAuthors:i.length-2,firstAuthor:i[0],secondAuthor:i[1],b:e=>a()("span",{style:he},void 0,e)}});return a()("span",{},void 0,r)}{const e=a()(L.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",description:"Bolded string for showing multiple authors that generated an activity update notification.",values:{numberOfOtherAuthors:r.length-2,firstAuthor:r[0],secondAuthor:r[1],b:e=>a()("span",{style:he},void 0,e)}});return a()("span",{},void 0,e)}}return a()("span",{style:he},void 0,a()(L.FormattedMessage,{defaultMessage:"Nobody",description:"Default text when there's an activity update with no users attached",id:"activitySection.authorPhrase.forNoAuthors.label"}))}(W.default.getIntl(),e,i)}const Ne=Oe;function Pe(e){window.__c={n:"ActivitySectionRedesignedIA"};const[t,i]=(0,c.useState)(!1),[o,r]=(0,c.useState)(!1),{notification:n,children:s,rootStore:d,icon:l,isPrivate:h,isLast:u,onBacklinkClicked:p,onArchiveClicked:g,onNotificationFrameClicked:m,onMarkAsReadClicked:v,onMarkAsUnreadClicked:f,navigableBlockId:b,showSnapshotButton:y,timestamp:S,header:A}=e,k=(0,X.O7)(),M=(0,Q.VK)((()=>"mentions"===Y.Z.state.currentTab),[]),_=!n||n.read,T=k.device.isMobile,w=Boolean(_&&M&&!y&&n),R=M&&!y?69:0,O=(0,Q.VK)((()=>{const e=k.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[k.WindowSizeStore]),C=(0,Me.yK)((e=>({container:{paddingTop:12,paddingBottom:s?12:8,paddingLeft:T?O.left:0,paddingRight:T?O.right:0,...w&&{opacity:.7}},headerAndAvatar:{display:"flex",paddingLeft:16,paddingRight:16+R},avatarAndStatusDot:{display:"flex",alignItems:"flex-start",position:"relative"},statusDot:{position:"absolute",opacity:1,left:-7,top:10},statusDotWrapper:{marginRight:T?3:2},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},divider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[R,s,O,T,w]),B=(0,c.useCallback)((e=>{n&&!n.read&&(o||(0,ge.ZP)({event:e,context:ge.Af.NotificationClick,callback:()=>{m(),q.createAndCommit({userAction:"ActivitySectionRedesignedIA.handleMarkAsRead",environment:k,perform:e=>{E.$h({notification:n,rootStore:d,transaction:e,read:!0})}})}}))}),[k,o,n,m,d]),I=(0,c.useCallback)((()=>i(!0)),[]),J=(0,c.useCallback)((()=>i(!1)),[]);return a()("div",{onMouseOver:I,onMouseLeave:J,onClick:B},void 0,a()(xe,{notification:n,rootStore:d,isMobile:T,isHovered:t,isMentionsTab:M,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onArchiveClicked:g,onMarkAsReadClicked:v,onMarkAsUnreadClicked:f}),a()("div",{style:C.container},void 0,a()("div",{style:C.headerAndAvatar},void 0,a()("div",{className:pe.FoE,style:C.avatarAndStatusDot},void 0,a()("div",{style:{marginRight:4}},void 0,M&&a()("div",{style:C.statusDotWrapper},void 0,!_&&a()(Re.z,{style:C.statusDot}))),l),a()(Ze,{timestamp:S,header:A,navigableBlockId:b,rootStore:d,hasChildren:Boolean(s),onBacklinkClicked:p}),y&&b&&a()(Le,{timestamp:S,navigableBlockId:b,rootStore:d}),h&&!n&&a()(we.Z,{style:C.privatePageBadge})),s&&a()("div",{className:pe.nU_},void 0,s)),!u&&a()("div",{style:C.divider}))}function xe(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:i,isMobile:o,isHovered:r,isMentionsTab:n,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c,onMouseEnter:l,onMouseLeave:h}=e,u=(0,Me.yK)((()=>({container:{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:o?23:8},body:{transition:"opacity 100ms ease-out",opacity:o||r?1:0,position:"absolute",right:16,top:12,zIndex:1}})),[o,r]);return n&&t?t.visited?null:a()("div",{style:u.container,onMouseEnter:l,onMouseLeave:h},void 0,a()("div",{style:u.body},void 0,a()(Te,{notification:t,rootStore:i,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c}))):null}function Ze(e){window.__c={n:"Header"};const{timestamp:t,header:i,hasChildren:o,rootStore:r,navigableBlockId:n,onBacklinkClicked:s}=e,d=(0,z.IS)(t),c=(0,z.uy)(t),l=(0,Me.yK)((e=>({header:{fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap"},path:{fontSize:12,color:e.lightTextColor},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4},headerWrapper:{display:"flex",marginTop:4,marginBottom:o?8:4}})),[o]);return a()("div",{style:l.header},void 0,a()("div",{className:pe.NFf},void 0,i),a()("div",{style:l.headerWrapper},void 0,a()("div",{style:l.time,className:pe.CZG},void 0,a()(ke.Z,{text:d,tooltipText:c,icon:te.Z.calendar})),n&&r&&a()(be.Z,{isLink:!0,innerStyle:l.path,store:$.G.createChildStore(r,{table:k.iU,id:n}),left:a()("div",{style:l.separatorDot},void 0,"·"),onClick:s})))}function Le(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:i,rootStore:o}=e,n=(0,X.O7)();if(t<new Date("2018-10-26").getTime())return null;const s=W.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),d=()=>{const e=$.G.createChildStore(o,{table:k.iU,id:i});ue.jN({environment:n,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return a()(ye.Z,{renderTooltip:()=>s,render:e=>c.createElement(fe.Z,r()({ariaLabel:s,onClick:d,icon:te.Z.versionHistoryThick},e))})}const Ue=c.memo(Pe);var Ve=i(84076),Ee=i(79931),Fe=i(64921);class qe extends l.Z{constructor(){super(...arguments),this.storeTypes={open:ve.default.of(!1)},this.handleOpen=()=>{this.stores.open.set(!0)}}renderComponent(){return this.stores.open.get()||this.props.items.length<=this.props.visible?a()("div",{},void 0,this.props.items):a()("div",{},void 0,this.props.items.slice(0,this.props.visible),a()(Fe.Z,{onClick:this.handleOpen,style:this.getStyle()},void 0,a()(L.FormattedMessage,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:this.props.items.length-this.props.visible}})))}getStyle(){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:this.theme.lightTextColor,padding:0,paddingLeft:52,paddingRight:16}}}qe.displayName="ViewMore";const Ke=qe;function Ge(e){return(0,x.SK)(e,{[p.$X]:p.tY.Notification})}function We(e){const{tab:t,environment:i,activity:o,notification:r,source:n}=e;He({target:"body",tab:t,environment:i,activity:o,notification:r,source:n,mightCloseTab:e.mightCloseTab??!0})}function He(e){const{target:t,environment:i,activity:o,notification:r,source:n,tab:a,mightCloseTab:s}=e,d="notifications_tab"===n?Y.Z.state.sessionId:void 0,c="notifications_tab"===n?Y.Z.isFilteredToUnreadOnly():void 0;U.trackClickUpdate(i,{target:t,activity_id:o.id,notification_id:null==r?void 0:r.id,sessionId:d,is_filtered:c,tab:a}),s&&V.pw({environment:i,target:t}),r&&g.e((0,K.getClientEventTracker)(i),{alreadyRead:r.read,notificationId:r.id,activityId:r.activity_id,from:t,sessionId:d})}function ze(e){const{notification:t,activity:i,environment:o,tab:r}=e,n={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r};return{onBacklinkClicked:e=>V.EQ({...n,backlinkPageId:e}),onArchiveClicked:()=>V._b(n),onMarkAsReadClicked:()=>V.cC(n),onMarkAsUnreadClicked:()=>V.u_(n),onNotificationFrameClicked:()=>V.ix(n)}}var $e=i(70203);function je(e){const{edits:t,rootStore:i}=e,o=d().uniqWith(t.flatMap((e=>e.authors||[])),d().isEqual);return d().compact(o.map((e=>function(e,t){if(e.table===I.KJ){const i=function(e,t){return $.U6.createChildStore(t,{table:I.KJ,id:e}).getValue()}(e.id,t);if(i)return(0,u.dp)(i)}else{const i=function(e,t){return(0,$.Kv)(t,{table:M.cZ,id:e}).getValue()}(e.id,t);if(i)return(0,u.D$)(i)}}(e,i))))}function Ye(e){const{tab:t,recordId:i,recordType:o,rootStore:r,environment:n}=e;if("all"===t){if(!i)return!1;let e;return e="block"===o?$.G.createChildStore(r,{table:k.iU,id:i}):"collection"===o?$.NW.createChildStore(r,{table:_.v,id:i}):$.H2.createChildStore(r,{table:C.bx,id:i}),(0,H.yi)(n,e)}return!1}function Xe(e){const{activity:t,rootStore:i}=e;if("commented"!==t.type)return;const o=i.getRecordValue({table:R.qF,id:t.discussion_id,spaceId:t.space_id});if(!o)return;if(!o.context)return;const r=(0,$e.VP)(o.context,(e=>!(0,$e.xw)(e)||(0,$e.h1)(e)===o.id));return{id:o.id,context:r}}var Qe=i(62385);const et={userSelect:"text",WebkitUserSelect:"text"},tt={padding:1,...et},it={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},ot={fontWeight:P.Z.fontWeight.semibold};function rt(e){return{padding:0,paddingLeft:nt(e),paddingRight:16,...et}}function nt(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function at(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function st(e){return{boxShadow:e.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}function dt(e){window.__c={n:"NotificationActions"};const{notification:t,source:i,isMobile:o,environment:r,rootStore:n,activity:s,tab:d}=e,c=Boolean(null==t?void 0:t.visited),l=(0,Me.yK)((e=>({container:{paddingLeft:nt({source:i,isMobile:o})-8,paddingTop:4}})),[o,i]);return c?a()("div",{style:l.container},void 0,a()(ct,{notification:t,environment:r,rootStore:n,activity:s,tab:d})):null}function ct(e){window.__c={n:"UnarchiveButton"};const{notification:t,environment:i,rootStore:o,activity:r,tab:n}=e,s=(0,Me.yK)((e=>({secondaryButton:at(e)})),[]);return Boolean(null==t?void 0:t.visited)?a()(Qe.Z,{onClick:()=>{t&&(q.createAndCommit({userAction:"Activity.handleUnarchive",environment:i,perform:e=>{E.E1({notificationId:t.id,visited:!1,rootStore:o,transaction:e})}}),V.F5({environment:i,activity:r,tab:n,notificationId:t.id,alreadyRead:t.read}))},style:s.secondaryButton},void 0,a()(L.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"})):null}var lt=i(31278),ht=i(76798);function ut(e){window.__c={n:"Title"};const{titledRecordStore:t,getRecordModel:i,source:o,tab:r,activity:n,notification:s}=e,d=(0,Q.VK)((()=>t.getModel()),[t]),l=(0,X.O7)(),h=(0,Q.VK)((()=>null==d?void 0:d.getRenderIcon({getRecordModel:i})),[d,i]),u=(0,Me.yK)((()=>({container:tt,icon:it,activityTitle:{display:"inline",whiteSpace:"normal",marginRight:void 0!==h?3:0,wordBreak:"break-word",...ot}})),[h]),p=(0,Q.VK)((()=>d&&Ge(d.getRenderUrl({getRecordModel:i}))),[d,i]);return d?a()(Ve.Z,{href:p,onClick:()=>function(e){const{tab:t,environment:i,activity:o,notification:r,source:n}=e;He({target:"title",tab:t,environment:i,activity:o,notification:r,source:n,mightCloseTab:e.mightCloseTab??!0})}({environment:l,activity:n,notification:s,source:o,tab:r}),external:!1,innerStyle:u.container,inline:!0},void 0,h&&c.createElement(c.Fragment,null,a()(lt.Z,{disabled:!0,icon:h,isEmptyPage:!1,size:18,style:u.icon}),a()("span",{},void 0," ")),a()(ht.Z,{store:t,style:u.activityTitle})):null}function pt(e){const{activity:t,rootStore:i,source:o,notification:n,isLast:s,isTopbarUpdatesMenu:d,tab:l,useRedesignedIA:h}=e,u=(0,D.hI)(t.edits??[]),p=u.length>0,g=$.G.createChildStore(i,{table:k.iU,id:u[0].navigable_block_id}),m=(0,Q.VK)((()=>je({edits:u,rootStore:i})),[u,i]),v=(0,Q.VK)((()=>De(m)),[m]),f=(0,X.O7)();if(!(0,Q.VK)((()=>g.isDefined()),[g])||!p)return null;const b=a()(ut,{titledRecordStore:g,getRecordModel:i.getRecordModel,activity:t,notification:n,source:o,tab:l});return h?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:m.length,authorOrAuthors:v,pageTitle:b}})),isLast:s,isPrivate:Ye({recordId:g.id,recordType:"block",tab:l,rootStore:i,environment:f}),rootStore:i,navigableBlockId:g.id,notification:n,icon:a()(Be,{authors:m}),showSnapshotButton:d},ze({notification:n,activity:t,environment:f,tab:l})),a()(Ke,{visible:5,items:u.map(((e,r)=>a()(gt,{edit:e,rootStore:i,onClick:()=>We({environment:f,activity:t,notification:n,tab:l,source:o}),source:o,isMobile:f.device.isMobile},r)))}),a()(dt,{notification:n,activity:t,source:o,tab:l,isMobile:f.device.isMobile,environment:f,rootStore:i})):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:m.length,authorOrAuthors:v,pageTitle:b}})),isLast:s,isPrivate:Ye({recordId:g.id,recordType:"block",tab:l,rootStore:i,environment:f}),rootStore:i,navigableBlockId:g.id,notification:n,icon:a()(Be,{authors:m}),showSnapshotButton:d},ze({notification:n,activity:t,environment:f,tab:l})),a()(Ke,{visible:5,items:u.map(((e,r)=>a()(gt,{edit:e,rootStore:i,onClick:()=>We({environment:f,activity:t,notification:n,tab:l,source:o}),source:o,isMobile:f.device.isMobile},r)))}),a()(dt,{notification:n,activity:t,source:o,tab:l,isMobile:f.device.isMobile,environment:f,rootStore:i}))}function gt(e){window.__c={n:"BlockPropertyEditComponent"};const{rootStore:t,edit:i,onClick:o,source:r,isMobile:n}=e,s=(0,Q.VK)((()=>function(e,t){const i=t.getRecordModel({table:k.iU,id:e.block_id}),o=(null==i?void 0:i.getType())===m.ZP.tableRow?t.getRecordModel({table:k.iU,id:i.getParentId()}):i;return null==o?void 0:o.getRenderUrl({getRecordModel:t.getRecordModel})}(i,t)||S._j.root),[i,t]);return a()(Ve.Z,{href:s,onClick:o,innerStyle:rt({source:r,isMobile:n})},void 0,a()(Ee.Z,{edit:i,rootStore:t}))}var mt=i(98459),vt=i(4083),ft=i(14976),bt=i(17731),yt=i(98165);function St(e){let{activity:t,notification:i,source:o,rootStore:n,tab:s,isLast:d,useRedesignedIA:l}=e;const h=t.edits??[];let u=h.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,N.t1)(e)}}));0===u.length&&0!==h.length&&"updates_sidebar"!==o&&(u=h);const p=u.length>0,g=(0,X.O7)(),m=n.getRecordStore(n,{table:R.qF,id:t.discussion_id,spaceId:t.space_id}),v=(0,Q.VK)((()=>m.isDefined()),[m]),f=(0,Q.VK)((()=>{const e=m.getParentPointer();if(e)return $.G.createChildStore(n,e)}),[m,n]),b=(0,Q.VK)((()=>Boolean(f&&f.isDefined())),[f]),y=$.G.createChildStore(n,{table:k.iU,id:t.navigable_block_id}),S=(0,Q.VK)((()=>y.isDefined()),[y]),A=(0,Q.VK)((()=>Boolean(f&&(0,yt.fl)((0,yt.qA)(f)))),[f]),M=(0,Q.VK)((()=>{if(!A||!f)return;const e=f.getModel();return e?Ge(e.getRenderUrl({getRecordModel:n.getRecordModel,discussionId:t.discussion_id})):void 0}),[A,f,n,t.discussion_id]),_=(0,Q.VK)((()=>je({edits:u,rootStore:n})),[u,n]),T=(0,Q.VK)((()=>De(_)),[_]),w=(0,c.useCallback)((e=>{if(We({tab:s,environment:g,activity:t,source:o,mightCloseTab:A}),!A&&f){const r=e.target;vt.oK({environment:g,discussionStore:m,rect:r.getBoundingClientRect(),blockStore:f,discussionLocation:_t({forReplyMenu:!0,source:o}),activityId:t.id,notificationId:null==i?void 0:i.id})}}),[t,A,f,m,g,i,o,s]),O=(0,c.useCallback)((()=>{!function(e){const{tab:t,environment:i,activity:o,notification:r,source:n}=e;He({target:"add_reaction",tab:t,environment:i,activity:o,notification:r,source:n,mightCloseTab:!1})}({tab:s,environment:g,activity:t,notification:i,source:o})}),[s,g,t,i,o]),C=a()(ut,{titledRecordStore:y,getRecordModel:n.getRecordModel,activity:t,notification:i,source:o,tab:s}),B=Ye({recordId:t.navigable_block_id,recordType:k.iU,tab:s,rootStore:n,environment:g}),I=g.device.isMobile,J=(0,Q.VK)((()=>_t({source:o,forReplyMenu:!1})),[o]);return p&&M&&S&&b&&v?l?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:_.length,authorOrAuthors:T,blockName:C},id:"activity.commentActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:d,isPrivate:B,rootStore:n,navigableBlockId:t.navigable_block_id,notification:i,icon:a()(Be,{authors:_}),showSnapshotButton:!1},ze({notification:i,environment:g,tab:s,activity:t})),a()(At,{activity:t,url:M,onClick:w,rootStore:n,source:o}),a()(Ke,{visible:5,items:u.map(((e,t,i)=>a()(Ve.Z,{onClick:w,href:M,innerStyle:rt({source:o,isMobile:I})},t,a()(Ee.Z,{edit:e,rootStore:n,type:"comment-edit",discussionLocation:J,onReactionClick:O}))))}),a()(kt,{activity:t,rootStore:n,source:o,tab:s,notification:i})):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:_.length,authorOrAuthors:T,blockName:C},id:"activity.commentActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:d,isPrivate:B,rootStore:n,navigableBlockId:t.navigable_block_id,notification:i,icon:a()(Be,{authors:_}),showSnapshotButton:!1},ze({notification:i,environment:g,tab:s,activity:t})),a()(At,{activity:t,url:M,onClick:w,rootStore:n,source:o}),a()(Ke,{visible:5,items:u.map(((e,t,i)=>a()(Ve.Z,{onClick:w,href:M,innerStyle:rt({source:o,isMobile:I})},t,a()(Ee.Z,{edit:e,rootStore:n,type:"comment-edit",discussionLocation:J,onReactionClick:O}))))}),a()(kt,{activity:t,rootStore:n,source:o,tab:s,notification:i})):null}function At(e){window.__c={n:"CommentContext"};const{url:t,onClick:i,activity:o,rootStore:r,source:n}=e,s=(0,Q.VK)((()=>Xe({activity:o,rootStore:r})),[o,r]),d=null==s?void 0:s.id,c=null==s?void 0:s.context,l=0===(0,$e.ll)(c).length,h=(0,X.O7)(),u=h.device.isMobile,p=(0,Me.Fg)(),g=(0,Me.yK)((e=>({linkbox:{...rt({source:n,isMobile:u}),display:"flex",alignItems:"flex-start",fontSize:14,...l&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0},blockContext:{flexShrink:0,alignSelf:"center",width:3,borderRadius:3,marginLeft:2,marginRight:8,height:20,background:ee.DB}})),[l,u,n]),m=(0,Q.VK)((()=>(0,ft.IY)({environment:h,textValue:c?{value:c,spaceId:o.space_id}:void 0,parentStore:r,disableHover:!0,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:d,theme:p,emojiType:(0,bt.e)(h),katex:h.KatexStore.getKatex(),formulaValueTypes:[]})),[r,h,c,d,p,o.space_id]);return s?a()(Ve.Z,{href:t,onClick:i,innerStyle:g.linkbox},void 0,l&&a()("div",{style:g.blockContext}),a()("div",{style:P.Z.textOverflowStyle},void 0,m)):null}function kt(e){window.__c={n:"CommentActions"};const{activity:t,rootStore:i,source:o,notification:r,tab:n}=e,s=i.getRecordStore(i,{table:R.qF,id:t.discussion_id,spaceId:t.space_id}),d=(0,Q.VK)((()=>s.isDefined()),[s]),l=(0,X.O7)(),h=l.device.isMobile,u=$.t1.createChildStore(i,{table:R.qF,id:t.discussion_id,spaceId:(0,mt.CG)(i.pointer.spaceId)}),p=(0,Q.VK)((()=>s.getParentId()),[s]),g=(0,c.useCallback)((e=>{if(!p)return;const a=$.G.createChildStore(i,{table:k.iU,id:p}),s=e.target,d=null==r?void 0:r.id;vt.oK({environment:l,discussionStore:u,rect:s.getBoundingClientRect(),blockStore:a,discussionLocation:_t({forReplyMenu:!0,source:o}),activityId:t.id,notificationId:d}),"notifications_tab"===o&&V.gY({environment:l,notificationId:d,alreadyRead:Boolean(null==r?void 0:r.read),activity:t,tab:n})}),[t,u,l,r,p,i,o,n]),m=(0,Me.yK)((e=>({container:{paddingLeft:nt({source:o,isMobile:h}),paddingTop:12,paddingBottom:4},actionButton:st(e)})),[h,o]),v=Boolean(null==r?void 0:r.visited);return d?a()("div",{style:m.container},void 0,a()(Qe.Z,{onClick:g,style:m.actionButton},void 0,a()(L.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})),v&&c.createElement(c.Fragment,null,a()(Mt,{}),a()(ct,{notification:r,environment:l,rootStore:i,activity:t,tab:n}))):null}function Mt(){return window.__c={n:"Separator"},a()("div",{style:{width:5,display:"inline-block"}})}function _t(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${V.Jn()}`}const Tt=c.memo(St);var wt=i(54584);function Rt(e){const{activity:t,rootStore:i,source:o,notification:n,isLast:s,tab:d,useRedesignedIA:l}=e,h=(0,X.O7)(),u=t.edits??[],p=u.length>0,g=u[0],m=$.G.createChildStore(i,{table:k.iU,id:g.navigable_block_id}),v=(0,Q.VK)((()=>m.isDefined()),[m]),f=$.G.createChildStore(i,{table:k.iU,id:t.mentioned_block_id}),b=(0,Q.VK)((()=>f.isDefined()),[f]),y=(0,Q.VK)((()=>{const e=f.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel})}),[f,i]),S=(0,Q.VK)((()=>i.getModel()),[i]),A=(0,Q.VK)((()=>(0,wt.QH)(W.default.getIntl(),S,t.mentioned_group_id)),[S,t]),M=(0,Q.VK)((()=>je({edits:t.edits||[],rootStore:i})),[t,i]),_=(0,Q.VK)((()=>De(M)),[M]),T=h.device.isMobile;if(!(p&&v&&b&&y))return null;const w=a()(ut,{titledRecordStore:m,activity:t,notification:n,source:o,tab:d,getRecordModel:i.getRecordModel}),R=Ye({recordId:m.id,recordType:k.iU,tab:d,rootStore:i,environment:h});return l?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in {pageName}",values:{authorOrAuthors:_,pageName:w,groupName:A},id:"activity.groupMentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:s,isPrivate:R,rootStore:i,navigableBlockId:m.id,notification:n,icon:a()(Be,{authors:M}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:y,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:T})},void 0,a()(Ee.Z,{edit:g,rootStore:i})),a()(dt,{notification:n,activity:t,source:o,tab:d,isMobile:T,environment:h,rootStore:i})):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in {pageName}",values:{authorOrAuthors:_,pageName:w,groupName:A},id:"activity.groupMentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:s,isPrivate:R,rootStore:i,navigableBlockId:m.id,notification:n,icon:a()(Be,{authors:M}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:y,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:T})},void 0,a()(Ee.Z,{edit:g,rootStore:i})),a()(dt,{notification:n,activity:t,source:o,tab:d,isMobile:T,environment:h,rootStore:i}))}function Ot(e){const{activity:t,rootStore:i,source:o,notification:n,isLast:s,tab:d,useRedesignedIA:l}=e,h=(0,X.O7)(),u=t.edits??[],p=u.length>0,g=$.G.createChildStore(i,{table:k.iU,id:u[0].navigable_block_id}),m=(0,Q.VK)((()=>g.isDefined()),[g]),v=$.G.createChildStore(i,{table:k.iU,id:t.reminder_block_id}),f=(0,Q.VK)((()=>v.isDefined()),[v]),b=(0,Q.VK)((()=>{const e=v.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel})}),[v,i]);if(!(p&&m&&f&&b))return null;const y=h.device.isMobile,S=Ge(b),A=a()(ut,{titledRecordStore:g,getRecordModel:i.getRecordModel,activity:t,notification:n,source:o,tab:d});return l?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:A}})),isLast:s,isPrivate:Ye({recordId:g.id,recordType:k.iU,tab:d,rootStore:i,environment:h}),rootStore:i,navigableBlockId:g.id,notification:n,icon:a()(Ie,{}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:S,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:y})},void 0,a()(Ee.Z,{edit:u[0],rootStore:i}))):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:A}})),isLast:s,isPrivate:Ye({recordId:g.id,recordType:k.iU,tab:d,rootStore:i,environment:h}),rootStore:i,navigableBlockId:g.id,notification:n,icon:a()(Ie,{}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:S,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:y})},void 0,a()(Ee.Z,{edit:u[0],rootStore:i})))}function Ct(e){const{activity:t,rootStore:i,source:o,notification:n,isLast:s,tab:d,useRedesignedIA:l}=e,h=(0,X.O7)(),u=t.edits??[],p=u.length>0,g=(0,Q.VK)((()=>je({edits:t.edits||[],rootStore:i})),[t,i]),m=(0,Q.VK)((()=>De(g)),[g]),v=u[0],f=$.zX.createChildStore(i,{table:B.e0,id:v.team_id}),b=(0,Q.VK)((()=>f.isDefined()),[f]),y=(0,Q.VK)((()=>f.getModel()),[f]),S=(0,Q.VK)((()=>null==y?void 0:y.getRenderIcon({getRecordModel:i.getRecordModel})),[y,i]),A=a()(Ve.Z,{onClick:e=>{We({environment:h,activity:t,notification:n,tab:d,source:o}),F.hI({environment:h,teamStore:f,shouldScroll:!0}),j.Z.setState({...j.Z.state,open:!1})},external:!1,innerStyle:Xt.pageLinkStyle,inline:!0},void 0,S&&c.createElement(c.Fragment,null,a()(lt.Z,{disabled:!0,icon:S,isEmptyPage:!1,size:18,style:Xt.recordIconStyle})),a()(ht.Z,{store:f,style:(k=void 0!==S,{display:"inline",whiteSpace:"normal",marginRight:k?3:0,wordBreak:"break-word",...Xt.boldStyle})}));var k;const M=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to teamspace {teamName}} other {{authorOrAuthors} invited you to {teamName}}}",values:{numberOfAuthors:g.length,authorOrAuthors:m,teamName:A},id:"activity.userInvitedToTeamActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return p&&b?l?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:M,isLast:s,isPrivate:!1,rootStore:i,notification:n,icon:a()(Be,{authors:g}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d}))):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:M,isLast:s,isPrivate:!1,rootStore:i,notification:n,icon:a()(Be,{authors:g}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d}))):null}function Bt(e){const{activity:t,rootStore:i,source:o,notification:n,isLast:s,tab:d,useRedesignedIA:l}=e,h=(0,X.O7)(),u=t.edits??[],p=u.length>0,g=u[0],m=$.G.createChildStore(i,{table:k.iU,id:g.navigable_block_id}),v=(0,Q.VK)((()=>m.isDefined()),[m]),f=$.G.createChildStore(i,{table:k.iU,id:t.mentioned_block_id}),b=(0,Q.VK)((()=>f.isDefined()),[f]),y=(0,Q.VK)((()=>{const e=f.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel})}),[f,i]),S=(0,Q.VK)((()=>je({edits:t.edits||[],rootStore:i})),[t,i]),A=(0,Q.VK)((()=>De(S)),[S]);if(!(p&&v&&b&&y))return null;const M=Ge(y),_=h.device.isMobile,T=Ye({recordId:m.id,recordType:"block",tab:d,rootStore:i,environment:h}),w=a()(ut,{titledRecordStore:m,getRecordModel:i.getRecordModel,activity:t,notification:n,source:o,tab:d});return l?c.createElement(Ue,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in {pageName}} other {{authorOrAuthors} mentioned you in {pageName}}}",values:{numberOfAuthors:S.length,authorOrAuthors:A,pageName:w},id:"activity.mentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:s,isPrivate:T,rootStore:i,navigableBlockId:m.id,notification:n,icon:a()(Be,{authors:S}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:M,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:_})},void 0,a()(Ee.Z,{edit:g,rootStore:i})),a()(dt,{notification:n,activity:t,source:o,tab:d,isMobile:_,environment:h,rootStore:i})):c.createElement(Ne,r()({timestamp:parseInt(t.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in {pageName}} other {{authorOrAuthors} mentioned you in {pageName}}}",values:{numberOfAuthors:S.length,authorOrAuthors:A,pageName:w},id:"activity.mentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:s,isPrivate:T,rootStore:i,navigableBlockId:m.id,notification:n,icon:a()(Be,{authors:S}),showSnapshotButton:!1},ze({notification:n,activity:t,environment:h,tab:d})),a()(Ve.Z,{href:M,onClick:()=>We({environment:h,activity:t,notification:n,tab:d,source:o}),innerStyle:rt({source:o,isMobile:_})},void 0,a()(Ee.Z,{edit:g,rootStore:i})),a()(dt,{notification:n,activity:t,source:o,tab:d,isMobile:_,environment:h,rootStore:i}))}var It=i(48298),Jt=i(91376),Dt=i(64404),Nt=i(61519),Pt=i(64369);class xt extends l.Z{constructor(){super(...arguments),this.storeTypes={role:ve.default.of(void 0)}}renderComponent(){const{accessRequestStore:e}=this.props;if(e.isDefined()){if(e.isResolvedSpaceMembershipRequest())return this.renderResolvedSpaceMembershipRequest();if(this.canResolveMembershipRequests())return a()("div",{style:{display:"flex",alignItems:"center"}},void 0,a()(Qe.Z,{onClick:()=>this.resolveMembershipRequest("approved"),style:this.getButtonStyle(!1)},void 0,a()(L.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label",description:"Button in notification to approve a membership request."})),a()(Qe.Z,{onClick:()=>this.resolveMembershipRequest("rejected"),style:{height:26,paddingLeft:8,paddingRight:8}},void 0,a()(L.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label",description:"Decline space membership request button in notification."})),!this.environment.device.isMobile&&c.createElement(c.Fragment,null,a()(Nt.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),a()(Qe.Z,{onClick:()=>{U.trackClickViewAllRequests(this.environment,{disable_membership_requests:this.props.spaceStore.getDisableMembershipRequests()}),this.handleOpenSettingsMembersRequests()},style:{height:26,paddingLeft:8,paddingRight:8}},void 0,a()(L.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label",description:"Button that takes user to the settings modal members requests tab to see all existing requests."}))))}}renderResolvedSpaceMembershipRequest(){const{accessRequestStore:e}=this.props;if(!e.isDefined())return;const t=e.isResolvedSpaceMembershipRequest()&&this.renderActor(e.getResolvedByPointer());return c.createElement(c.Fragment,null,a()(Pt.Z,{isSecondaryColor:!0},void 0,"approved"===e.getStatus()?a()(L.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:t},description:"Message showing that space membership request has been approved."}):a()(L.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:t},description:"Message showing that space membership request has been declined."})),a()(Pt.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,oe.Yx)(Math.min(e.getResolvedTime(),Date.now()),"medium_with_time",(0,ie.E2)(this.props.intl))))}handleOpenSettingsMembersRequests(){Jt.r({currentTab:"members",subtab:Dt.Q.Requests})}canResolveMembershipRequests(){return this.props.spaceStore.canEditMembership()}renderActor(e){const{table:t,id:i}=e;return De(d().compact([this.getActor(t,i)]))}getActor(e,t){if(e===I.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===M.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}async resolveMembershipRequest(e){if(!this.canResolveMembershipRequests())return;const t=this.environment,{spaceStore:i,accessRequestStore:o}=this.props;if(!o.isDefined())return;const r=this.getActor(I.KJ,o.getForActorId());r&&r.table===I.KJ&&await It.kn({environment:t,store:i,accessRequestStore:o,forActor:r.value,status:e,from:"notification"})}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}}xt.displayName="ApproveSpaceMembershipActivityAction";const Zt=(0,L.injectIntl)(xt);var Lt=i(1136),Ut=i(45669),Vt=i(13991),Et=i(27006),Ft=i(10279),qt=i(9953),Kt=i(21115),Gt=i(78291),Wt=i(7567);class Ht extends l.Z{constructor(){super(...arguments),this.storeTypes={role:ve.default.of(void 0)},this.handleApproveMembershipRequest=async()=>{},this.handleGrantPageAccess=async()=>{const{targetBlockStore:e,accessRequestStore:t}=this.props,i=this.getInviteTargetWithNewPermissionItem();if(!("permissionItem"in i))return;const o=this.environment.currentUser.id;if(!o)return;if("type"in i){let t;if("existingUser"===i.type){t=(await Ft.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:i.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===i.type){t=(await Ft.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,N.t1)(i);if(!t)return}q.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:this.environment,perform:r=>{"type"in i||Ft.ep({environment:this.environment,transaction:r,store:e,permissionItems:[i.permissionItem]}),qt.sW({store:t,transaction:r,data:{granted_time:Date.now(),granted_by_table:I.KJ,granted_by_id:o,resolved_time:Date.now(),resolved_by_table:I.KJ,resolved_by_id:o,status:"approved"}})}});const r=t.getValue(),n=r&&r.created_time&&r.granted_time?r.granted_time-r.created_time:void 0;U.trackGrantAccess(this.environment,{requestId:r&&r.id,timeElapsedSinceRequest:n,newAccessLevel:i.permissionItem.role,...this.getGrantOrIgnoreAccessArgs()})},this.handleRoleChange=e=>{const t=this.props.accessRequestStore.id,i=this.stores.role.state;this.stores.role.setState(e),U.trackChangeGrantAccessLevel(this.environment,{requestId:t,previousAccessLevel:i,newAccessLevel:e,...this.getGrantOrIgnoreAccessArgs()})},this.handleArchive=()=>{const{notification:e}=this.props;e&&(q.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:this.environment,perform:t=>{E.aZ({notification:e,rootStore:this.props.accessRequestStore,transaction:t})}}),U.trackIgnoreAccessRequest(this.environment,this.getGrantOrIgnoreAccessArgs()))}}renderComponent(){const e=this.props.accessRequestStore.getValue();if(!e)return;if((0,A.Kc)(e))return this.renderGrantedAccessRequest(e);if(!this.canGrantAccess())return;const t=e.parent_table===C.bx,i=this.getCurrentPermissionItem();if(i&&!t){const t=this.renderActor(e.for_actor_table,e.for_actor_id),o=i.role===this.getRole();return c.createElement(c.Fragment,null,a()(Pt.Z,{isSecondaryColor:!0,style:{marginBottom:6}},void 0,a()(L.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",description:"Shown if the user who requested access already has access",values:{requestingUser:t}})),a()(Wt.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:k.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===I.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!0)}),a()(Qe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(o)},void 0,a()(L.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label",description:"Change permission button for page access requests in notification."})),this.renderArchiveButton())}return c.createElement(c.Fragment,null,a()(Wt.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:k.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===I.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!1)}),a()(Qe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(!1)},void 0,a()(L.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label",description:"Button in notification to grant access to a page access request."})),this.renderArchiveButton())}renderGrantedAccessRequest(e){const t=this.renderActor(e.granted_by_table,e.granted_by_id),i=(0,oe.$b)(Math.min(e.granted_time,Date.now()),Vt.SP,W.default.getIntl());return c.createElement(c.Fragment,null,a()(Pt.Z,{isSecondaryColor:!0},void 0,a()(L.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",description:"Approval message for page access requests in notification.",values:{grantedBy:t,time:i}})),a()(Pt.Z,{isSmall:!0,isSecondaryColor:!0},void 0,i))}renderArchiveButton(){const{notification:e}=this.props;if(e&&!e.visited)return a()(Qe.Z,{onClick:this.handleArchive,style:{height:26,paddingLeft:8,paddingRight:8}},void 0,a()(L.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label",description:"Ignore page access request button in notification."}))}getRole(){const e=this.getCurrentPermissionItem(),t=e&&e.role;return this.stores.role.state||t||this.props.initialRole}getNewPermissionItem(){const e=this.props.accessRequestStore.getValue();if(e)return e.for_actor_table===I.KJ?{type:"user_permission",user_id:e.for_actor_id,role:this.getRole()}:{type:"bot_permission",bot_id:e.for_actor_id,role:this.getRole()}}getInviteTargetWithNewPermissionItem(){const e=this.getNewPermissionItem();if(!e)return{};if(this.getCurrentPermissionItem())return{permissionItem:e};const{data:t}=Gt.default.state;if("user_permission"===e.type){const i=this.rootStore.getRecordValue({table:I.KJ,id:e.user_id}),o=t?Kt.CM(t):[],r=o&&o.some((t=>t.userId===e.user_id));return i&&!r?{type:"existingUser",value:i,permissionItem:e}:{permissionItem:e}}if("bot_permission"===e.type){const i=this.rootStore.getRecordValue({table:M.cZ,id:e.bot_id}),o=(t?Kt.NM(t):[]).some((t=>t.botId===e.bot_id));return i&&!o?{type:"bot",value:i,permissionItem:e}:{permissionItem:e}}(0,N.t1)(e)}getCurrentPermissionItem(){const e=this.props.accessRequestStore.getValue();if(!e)return;const t=this.props.targetBlockStore.getPermissionItems();for(const i of t){if(e.for_actor_table===I.KJ&&(0,Et.jg)(i)&&i.user_id===e.for_actor_id)return i;if(e.for_actor_table===M.cZ&&(0,Et.FB)(i)&&i.bot_id===e.for_actor_id)return i}}canGrantAccess(){return this.props.targetBlockStore.canAdmin()}renderActor(e,t){return De(d().compact([this.getActor(e,t)]))}getActor(e,t){if(e===I.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===M.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}getGrantOrIgnoreAccessArgs(){const{notification:e}=this.props;return{tab:V.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}}Ht.displayName="GrantPageAccessActivityAction";const zt=Ht;var $t=i(18698);const jt=function(e){window.__c={n:"ApproveTeamMembershipActivityButton"};const{accessRequestStore:t,teamStore:i}=e,o=(0,X.O7)(),r=(0,L.useIntl)(),{isRequestResolved:n,resolvedStatus:s,resolvedTime:d}=(0,Q.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),c=(0,Q.VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=$.U6.createChildStore(t,{table:I.KJ,id:e});return i?i.getDisplayName(r):void 0}),[t,r]),l=async e=>{await $t.ow({environment:o,teamStore:i,accessRequestStore:t,status:e})},h=(0,Me.yK)((e=>({container:{display:"flex",alignItems:"center"},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow},declineButton:{height:26,paddingLeft:8,paddingRight:8}})),[]);return a()("div",{style:h.container},void 0,n?a()("div",{},void 0,a()(Pt.Z,{isSecondaryColor:!0},void 0,a()(L.FormattedMessage,"approved"===s?{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:c},description:"Message showing that a team membership request has been approved."}:{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:c},description:"Message showing that a team membership request has been declined."})),a()(Pt.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,oe.Yx)(Math.min(d,Date.now()),"medium_with_time",(0,ie.E2)(r)))):a()("div",{},void 0,a()(Qe.Z,{style:h.approveButton,onClick:()=>l("approved")},void 0,a()(L.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label",description:"Button in notification to approve a team membership request."})),a()(Qe.Z,{style:h.declineButton,onClick:()=>l("rejected")},void 0,a()(L.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label",description:"Decline team membership request button in notification."}))))};class Yt extends l.Z{constructor(e){super(e),this.renderBlockEdit=(e,t,i)=>{let o=this.getRecordValue({table:k.iU,id:e.block_id});o&&o.type===m.ZP.tableRow&&(o=this.getRecordValue({table:k.iU,id:o.parent_id}));const r=o?this.withPageVisitSource(b.kk.fromBlock(o).getRenderUrl({getRecordModel:this.getRecordModel})):S._j.root;return"block-deleted"===e.type?e.block_data.block_value.type===m.ZP.page?a()(Ve.Z,{href:r,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},t,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore})):a()("div",{style:this.getEditButtonStyle()},t,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore})):a()(Ve.Z,{href:r,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},t,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore}))},this.renderCollectionPropertyEdit=(e,t)=>{if("collection-property-changed"===e.type)return a()(Ve.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore}))},this.handleUnarchive=()=>{const{notification:e,rootStore:t}=this.props;e&&(q.createAndCommit({userAction:"Activity.handleUnarchive",environment:this.environment,perform:i=>{E.E1({notificationId:e.id,visited:!1,rootStore:t,transaction:i})}}),V.F5(this.getBaseNotificationArgs()))},this.getRecordStore=e=>this.props.rootStore.getRecordStore(this.props.rootStore,e),this.getUserValue=e=>$.U6.createChildStore(this.props.rootStore,{table:I.KJ,id:e}).getValue(),this.getBotValue=e=>(0,$.Kv)(this.props.rootStore,{table:M.cZ,id:e}).getValue(),this.getAuthorActor=e=>{if(e.table===I.KJ){const t=this.getUserValue(e.id);if(t)return(0,u.dp)(t)}else{const t=this.getBotValue(e.id);if(t)return(0,u.D$)(t)}},this.getSpaceStore=e=>$.H2.createChildStore(this.props.rootStore,{table:C.bx,id:e}),this.getTeamStore=e=>$.zX.createChildStore(this.props.rootStore,{table:B.e0,id:e}),this.handleMarkAsUnreadClicked=()=>{V.u_(this.getBaseNotificationArgs())},this.getDiscussionContext=()=>{const e=Xe({activity:this.props.activity,rootStore:this.props.rootStore});if(e)return e.context},this.handleTrackBacklinkClick=this.handleTrackBacklinkClick.bind(this),this.handleTrackArchiveClicked=this.handleTrackArchiveClicked.bind(this),this.handleNotificationFrameClicked=this.handleNotificationFrameClicked.bind(this),this.handleMarkAsReadClicked=this.handleMarkAsReadClicked.bind(this)}willMountOrUpdate(){this.warmCommentData(),this.environment.KatexStore.loadIfNeeded(this.getDiscussionContext)}warmCommentData(){if("commented"===this.props.activity.type){const e=this.getRecordStore({table:R.qF,id:this.props.activity.discussion_id,spaceId:this.props.activity.space_id});if(e.isDefined()){const t=e.getCommentStores();for(const e of t)if(e.isDefined()&&e.getCreatedByTable()&&e.getCreatedById()){this.getRecordStore(e.getCreatedByPointer()).load()}}}}renderComponent(){const{activity:e,rootStore:t,source:i,notification:o,isLast:r,isTopbarUpdatesMenu:n,tab:s,useRedesignedIA:d}=this.props;switch(e.type){case"block-edited":return this.renderBlockEditActivity(e);case"block-property-edited":return a()(pt,{activity:e,rootStore:t,source:i,tab:s,notification:o,isLast:r,isTopbarUpdatesMenu:n,useRedesignedIA:d});case"collection-row-created":case"collection-row-deleted":return this.renderCollectionRowActivity(e);case"top-level-block-created":case"top-level-block-deleted":return this.renderTopLevelBlockActivity(e);case"permissions-edited":return this.renderPermissionsActivity(e);case"permission-group-edited":return this.renderPermissionGroupActivity(e);case"user-mentioned":return a()(Bt,{activity:e,rootStore:t,source:i,notification:o,isLast:r,isTopbarUpdatesMenu:n,tab:s,useRedesignedIA:d});case"commented":return a()(Tt,{activity:e,source:i,rootStore:t,notification:o,tab:s,isLast:r,useRedesignedIA:d});case"user-invited":return this.renderUserInvitedActivity(e);case"collection-edited":return this.renderCollectionEdited(e);case"collection-view-edited":return this.renderCollectionViewEdited(e);case"collection-property-edited":return this.renderCollectionPropertyEdited(e);case"reminder":return a()(Ot,{activity:e,rootStore:t,source:i,notification:o,isLast:r,isTopbarUpdatesMenu:n,tab:s,useRedesignedIA:d});case"page-locked":case"page-unlocked":return this.renderPageLockActivity(e);case"email-edited":return this.renderEmailEdited(e);case"access-requested":return this.renderAccessRequested(e);case"page-deleted":case"page-restored":case"page-permanently-deleted":return this.renderPageDeleteOrRestoreActivity(e);case"team-membership-edited":return a()(Ct,{activity:e,rootStore:t,source:i,notification:o,isLast:r,tab:s,useRedesignedIA:d});case"private-content-transferred":return this.renderPrivateContentTransferredActivity(e);case"permission-group-mentioned":return a()(Rt,{activity:e,rootStore:t,source:i,notification:o,isLast:r,tab:s,useRedesignedIA:d});case"verification-expired":return this.renderVerificationExpiredActivity(e);default:(0,N.t1)(e)}}withPageVisitSource(e){return(0,x.SK)(e,{[p.$X]:p.tY.Notification})}renderBlockEditActivity(e){if(!e.edits)return;const t=(0,D.hI)(e.edits).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==w.x_}));if(0===t.length)return;const i=this.getBlockStore(t[0].navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(t),n=De(o),s=this.renderTitle(i);return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:o.length,authorOrAuthors:n,pageTitle:s}})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:a()(Be,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),a()(Ke,{visible:5,items:t.map(this.renderBlockEdit)}),this.renderNotificationActions())}renderCollectionRowActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.collection_row_id);if(!i.isDefined())return;if(!i.getProperties())return;const o=this.getAuthors(e.edits),n=De(o),s=this.renderTitle(i),d="collection-row-created"===t.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {pageTitle}} other {{authorOrAuthors} created {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,pageTitle:s},id:"activity.collectionRowCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {pageTitle}} other {{authorOrAuthors} deleted {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,pageTitle:s},id:"activity.collectionRowDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,d),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:a()(Be,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderTopLevelBlockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.top_level_block_id);if(!i.isDefined())return;const o=i.hasSpacePermission(),n=this.getAuthors(e.edits),s=De(n),d=this.renderTitle(i);let l;return l=o?"top-level-block-created"===t.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created workspace page {pageTitle}} other {{authorOrAuthors} created workspace page {pageTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockWorkspaceCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted workspace page {pageTitle}} other {{authorOrAuthors} deleted workspace page {pageTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockWorkspaceDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"top-level-block-created"===t.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created private page {pageTitle}} other {{authorOrAuthors} created private page {pageTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockPrivateCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted private page {pageTitle}} other {{authorOrAuthors} deleted private page {pageTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockPrivateDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,notification:this.props.notification,icon:a()(Be,{authors:n}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderPermissionsActivity(e){if(!e.edits)return;const t=(0,D.hI)(e.edits);if(0===t.length)return;let i,o;const n=t[0];if(n.navigable_block_id){const e=this.getBlockStore(n.navigable_block_id);if(!e.isDefined())return;o=this.renderTitle(e),i=this.getIsRecordPrivateToUser(e.id,"block")}else{const e=this.getSpaceStore(n.space_id);if(!e.isDefined())return;o=this.renderTitle(e),i=this.getIsRecordPrivateToUser(n.space_id,"space")}const{autojoinEdits:s,inheritanceEdits:d,otherEdits:l}=h.md(e.edits),u=[];s.forEach(((e,t)=>{const n=this.getAuthors([e]),s=De(n);u.push(c.createElement(Ne,r()({key:`autojoin-${t}`,timestamp:e.timestamp,header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} joined {pageOrSpaceName}} other {{authorOrAuthors} joined {pageOrSpaceName}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,pageOrSpaceName:o},id:"activity.permissionsActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:n}),showSnapshotButton:!1},this.getActivitySectionHandlers())))})),d.forEach(((t,n)=>{const s=this.getAuthors([t]),d=De(s);let l;"permission-restriction-created"===t.type?l=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restricted access for {pageOrSpaceName}} other {{authorOrAuthors} restricted access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:s.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restrictPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-restriction-deleted"===t.type&&(l=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored inherited access for {pageOrSpaceName}} other {{authorOrAuthors} restored inherited access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:s.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restorePermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),u.push(c.createElement(Ne,r()({key:`inheritance-${n}`,timestamp:parseInt(e.end_time),header:a()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:t.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()),a()("div",{style:this.getEditButtonStyle()},void 0,a()(Ee.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions()))}));const p=(t,o,s)=>{if(t.length>0){const d=this.getAuthors(t);u.push(c.createElement(Ne,r()({key:o,timestamp:parseInt(e.end_time),header:s,isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:n.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:d}),showSnapshotButton:!1},this.getActivitySectionHandlers()),t.map(((e,t,i)=>a()("div",{style:this.getEditButtonStyle()},t,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore},t)))),this.renderNotificationActions()))}},g=l.filter((e=>!e.inSudoMode));if(g.length>0){const e=this.getAuthors(g),t=De(e);p(g,"other",a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}}",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}const m=l.filter((e=>e.inSudoMode));if(m.length>0){const e=this.getAuthors(m),t=De(e);p(m,"other-sudo",a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}} using administrator privileges",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivityInSudoMode.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}return u}renderPermissionGroupActivity(e){if(!e.edits)return;const t=(0,D.hI)(e.edits)[0];if(!t)return;const i=this.getSpaceStore(t.space_id);if(!i.isDefined())return;const o=this.withPageVisitSource(i.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),n=this.renderPermissionGroupTitle((0,y.c_)({activity:e,getRecordValue:this.getRecordValue}),e.space_id),s=this.getAuthors(e.edits);return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,this.renderPermissionGroupEditedHeader({activity:e,authors:s,groupName:n})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.space_id,"space"),rootStore:this.props.rootStore,notification:this.props.notification,icon:a()(Be,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()),a()(Ve.Z,{href:o,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},void 0,a()(Ee.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderAccessRequestedActions(e){const{rootStore:t}=this.props;if(!(e.edits||[])[0])return;const i=this.getRecordStore({table:A.J8,id:e.access_request_id});if(!i.isDefined())return;const o=i.getParentTable(),r=i.getParentId();switch(o){case k.iU:const e=$.G.createChildStore(t,{table:o,id:r});if(!e.canAdmin())return;return a()("div",{style:this.getActionPrimaryContainerStyle()},void 0,a()(zt,{accessRequestStore:i,targetBlockStore:e,initialRole:"reader",buttonStyle:this.getActionButtonStyle(),notification:this.props.notification}));case C.bx:const n=$.H2.createChildStore(t,{table:o,id:r});return a()("div",{style:this.getActionPrimaryContainerStyle()},void 0,a()(Zt,{accessRequestStore:i,spaceStore:n,initialRole:"reader",buttonStyle:this.getActionButtonStyle(),notification:this.props.notification}));case B.e0:const s=$.zX.createChildStore(t,{table:o,id:r});return a()("div",{style:this.getActionPrimaryContainerStyle()},void 0,a()(jt,{accessRequestStore:i,teamStore:s}));default:(0,N.t1)(o)}}renderUnarchiveButton(){return a()(Qe.Z,{onClick:this.handleUnarchive,style:this.getActionSecondaryButtonStyle()},void 0,a()(L.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"}))}renderNotificationActions(){if(this.canUnarchive())return a()("div",{style:this.getActionContainerStyle()},void 0,this.renderUnarchiveButton())}renderUserInvitedActivity(e){if(!e.edits)return;let t,i,o;const n=this.getAuthors(e.edits),s=De(n),d=0===n.filter(u.uC).length,l=parseInt(e.end_time),h=e.edits[0];if(h.navigable_block_id){const r=this.getBlockStore(h.navigable_block_id);if(!r.isDefined())return;const c=this.renderTitle(r),u=(0,J.$e)(r.getModel(),e);if(u){const t=this.getRecordValue({table:O.Tu,id:u,spaceId:e.space_id});t&&t.message&&t.created_time<=l+5*Z.hM&&(o={message:null==t?void 0:t.message,url:this.withPageVisitSource(r.getModel().getRenderUrl({getRecordModel:this.getRecordModel}))})}i=a()(L.FormattedMessage,d?{defaultMessage:"You have been invited to {blockName}",values:{blockName:c},id:"activity.userInvitedActivityNavigableBlockByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {blockName}} other {{authorOrAuthors} invited you to {blockName}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,blockName:c},id:"activity.userInvitedActivityNavigableBlock.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(r.id,"block")}else if(h.permission_group_id){const e=(0,y.Bg)({spaceId:h.space_id,permissionGroupId:h.permission_group_id,getRecordValue:this.getRecordValue}),o=this.renderPermissionGroupTitle(e,h.space_id);i=a()(L.FormattedMessage,d?{defaultMessage:"You have been added to group {groupName}",values:{groupName:o},id:"activity.userInvitedActivityGroupIdByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,groupName:o},id:"activity.userInvitedActivityGroupId.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(h.space_id,"space")}else{const e=this.getSpaceStore(h.space_id);if(!e)return;const o=this.renderTitle(e);i=a()(L.FormattedMessage,d?{defaultMessage:"You have been invited to {spaceName}",values:{spaceName:o},id:"activity.userInvitedActivityOtherInviteByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {spaceName}} other {{authorOrAuthors} invited you to {spaceName}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,spaceName:o},id:"activity.userInvitedActivityOtherInvite.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),t=this.getIsRecordPrivateToUser(h.space_id,"space")}const p=d?void 0:a()(Be,{authors:n});return c.createElement(Ne,r()({timestamp:l,header:a()("span",{},void 0,i),isLast:this.props.isLast,isPrivate:t,rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:p,showSnapshotButton:!1},this.getActivitySectionHandlers()),o&&a()(Ve.Z,{href:o.url,onClick:()=>this.trackBodyClick(),innerStyle:this.getInviteMessageStyle()},void 0,o.message))}renderPrivateContentTransferredActivity(e){if(!e.edits)return;const t=e.edits[0],i=t.from_user_id,o=this.getRecordValue({table:I.KJ,id:i});if(!o)return;const n=t.to_user_id;if(!this.getRecordValue({table:I.KJ,id:n}))return;const s=this.getBlockStore(e.navigable_block_id);if(!s.isDefined())return;const d=(0,u.$4)(W.default.getIntl(),{table:I.KJ,value:o}),l=this.getAuthors(e.edits),h=De(l),p=a()(L.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you: {pageName}",values:{authorPhrase:h,fromUserName:d,pageName:this.renderTitle(s)},id:"activity.privateContentTransferred.header",description:"Notification header for when private content is transferred from one user to another."});return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:p,isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(s.id,"block"),rootStore:this.props.rootStore,notification:this.props.notification,icon:a()(Be,{authors:l}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderVerificationExpiredActivity(e){const t=this.getBlockStore(e.navigable_block_id);if(!t.isDefined())return;const i=this.getRecordStore({table:_.v,id:e.collection_id,spaceId:e.space_id});if(!i.isDefined())return;const o=a()(L.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:this.renderTitle(t),boldtext:e=>a()("span",{style:{fontWeight:500}},void 0,e)},id:"activity.verificationExpired.header",description:"Notification header for when verification for a page has expired."});let n=a()(L.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown",description:"Label for a user when the user info is unknown for some reason"});const s=i.getSchema(),d=Object.keys(s).find((e=>{var t;return"verification"===(null===(t=s[e])||void 0===t?void 0:t.type)}));if(d){const e=t.getPropertyValue(d),i=v._w(e);if(i){const e=i[0],t=(0,u.Hl)({pointer:e,getRecordValue:this.getRecordValue});t.value&&(n=De([t]))}}const l=parseInt(e.start_time),h=parseInt(e.end_time);return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:o,isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(t.id,"block"),rootStore:i,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:a()(Je,{}),showSnapshotButton:!1},this.getActivitySectionHandlers()),a()("div",{style:{fontSize:14,...this.getEditButtonStyle()}},void 0,a()(L.FormattedMessage,l&&h?{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:n,startDate:(0,z.gs)(parseInt(e.start_time)),endDate:(0,z.gs)(parseInt(e.end_time))},id:"activity.verificationExpired.contentWithTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it and when."}:{defaultMessage:"Last verified by {person}",values:{person:n},id:"activity.verificationExpired.contentWithoutTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it."})),a()("div",{style:this.getActionContainerStyle()},void 0,this.canUnarchive()&&this.renderUnarchiveButton()))}renderCollectionEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:_.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=e.edits[0];if(!i)return;const o=this.withPageVisitSource(t.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),n=this.getAuthors(e.edits),s=De(n),d=this.renderTitle(t),l="collection-created"===i.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {collectionTitle}} other {{authorOrAuthors} created {collectionTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,collectionTitle:d},id:"activity.collectionCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {collectionTitle}} other {{authorOrAuthors} edited {collectionTitle}}}",values:{numberOfAuthors:n.length,authorOrAuthors:s,collectionTitle:d},id:"activity.collectionEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:n}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),h.OC(i)&&this.renderCollectionDescriptionEdit(i,o),this.renderNotificationActions())}renderCollectionDescriptionEdit(e,t){return a()(Ve.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,a()(Ee.Z,{edit:e,rootStore:this.props.rootStore}))}renderCollectionViewEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:_.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=this.getRecordStore({table:T.n,id:e.collection_view_id,spaceId:e.space_id});if(!i.isDefined())return;const o=(0,D.hI)(e.edits)[0];if(!o)return;const n=this.renderCollectionViewTitle(i),s=this.renderTitle(t),d=this.getAuthors(e.edits),l=De(d);let h;return h="collection-view-created"===o.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:n},id:"activity.collectionViewCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-view-deleted"===o.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:n},id:"activity.collectionViewDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:n},id:"activity.collectionViewEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,h),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyEdited(e){if(!e.edits)return;const t=(0,D.hI)(e.edits),i=t[0];if(!i)return;const o=this.getRecordStore({table:_.v,id:e.collection_id,spaceId:e.space_id});if(!o.isDefined())return;const n=this.withPageVisitSource(o.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),s="collection-property-changed"===i.type?i.collection_property_data.after:i.collection_property_data,d=this.getAuthors(e.edits),l=De(d),h=this.renderTitle(o),u=this.renderCollectionPropertyTitle(s);let p;return p="collection-property-created"===i.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-property-deleted"===i.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,p),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.notification,icon:a()(Be,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),a()(Ke,{visible:5,items:t.map((e=>this.renderCollectionPropertyEdit(e,n)))}),this.renderNotificationActions())}renderPageLockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(e.edits),n=De(o),s=this.renderTitle(i),d="page-locked"===e.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} locked {blockTitle}} other {{authorOrAuthors} locked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,blockTitle:s},id:"activity.pageLocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} unlocked {blockTitle}} other {{authorOrAuthors} unlocked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,blockTitle:s},id:"activity.pageUnlocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:a()(Be,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderEmailEdited(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getAuthors(e.edits),o=De(i);return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:i.length,authorOrAuthors:o,oldEmail:t.old_email,newEmail:t.new_email},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:!1,rootStore:this.props.rootStore,notification:this.props.notification,icon:a()(Be,{authors:i}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}getAccessRequestHeader(e,t){const i=t.parent_table;switch(i){case C.bx:return this.renderMembershipRequestHeader(e);case B.e0:return this.renderTeamMembershipRequestHeader(e);case k.iU:return this.renderAccessRequestedHeader(e);default:(0,N.t1)(i)}}renderTeamMembershipRequestHeader(e){if(!e.edits||!e.team_id)return;const t=De(this.getAuthors(e.edits)),i=this.getTeamStore(e.team_id),o=this.renderTeamTitle(i);return a()(L.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:a()("span",{style:{fontWeight:P.Z.fontWeight.semibold}},void 0,t),teamName:o},id:"activity.teamAccessRequest.header",description:"Notification header describing that a user created a team access request."})}renderMembershipRequestHeader(e){if(!e.edits)return;const t=this.getRecordValue({table:A.J8,id:e.access_request_id});if(!t||t.for_actor_table!==I.KJ)return;const i=this.getRecordValue({table:t.for_actor_table,id:t.for_actor_id});if(!i)return;if(t.for_actor_id===t.created_by_id){const e=i.name?`${i.name} (${i.email})`:i.email;return a()(L.FormattedMessage,{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:a()("span",{style:{fontWeight:P.Z.fontWeight.semibold}},void 0,e)},id:"activity.accessRequestedMembershipFromGuest.header",description:"Notification header describing that a user created a membership request for themself."})}const o=this.getAuthors(e.edits),r=De(o);return a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:o.length,authorOrAuthors:r,invitee:a()("span",{style:{fontWeight:P.Z.fontWeight.semibold}},void 0,i.email)},id:"activity.accessRequestedMembership.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}renderAccessRequestedHeader(e){if(!e.edits)return;if(!e.navigable_block_id)return;const t=this.getBlockStore(e.navigable_block_id);if(!t.isDefined())return;const i=this.getAuthors(e.edits),o=De(i);return a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:o,pageName:this.renderTitle(t)},id:"activity.accessRequested.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}renderAccessRequested(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getRecordValue({table:A.J8,id:e.access_request_id});if(!i)return;if(i.parent_table===C.bx&&!(0,G.p1)())return;const o=this.getAccessRequestHeader(e,i),{message:n}=t,s=this.getAuthors(e.edits),d=De(s);return c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,o),isLast:this.props.isLast,isPrivate:!1,rootStore:this.props.rootStore,notification:this.props.notification,icon:a()(Be,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n&&a()("div",{style:{paddingLeft:this.getActivityContentLeftPadding(),paddingRight:16,marginTop:8,marginBottom:8}},void 0,a()(Pt.Z,{isSmall:!0},void 0,a()(L.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:d}})),a()(Pt.Z,{isMultiline:!0,style:{whiteSpace:"pre-wrap"}},void 0,n)),this.renderAccessRequestedActions(e),this.renderNotificationActions())}renderPageDeleteOrRestoreActivity(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getRecordStore({table:k.iU,id:t.navigable_block_id,spaceId:t.space_id});if(!i.isDefined())return;const o=this.getAuthors(e.edits),n=De(o),s=this.renderTitle(i);let d;return"page-deleted"===e.type?d=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {blockTitle}} other {{authorOrAuthors} deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,blockTitle:s},id:"emailActivity.pageDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-restored"===e.type?d=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored {blockTitle}} other {{authorOrAuthors} restored {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,blockTitle:s},id:"emailActivity.pageRestored.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-permanently-deleted"===e.type?d=a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} permanently deleted {blockTitle}} other {{authorOrAuthors} permanently deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:n,blockTitle:s},id:"emailActivity.pagePermanentlyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):(0,N.t1)(e),c.createElement(Ne,r()({timestamp:parseInt(e.end_time),header:a()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.notification,icon:a()(Be,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyTitle(e){const{theme:t}=this;return a()("span",{style:{...Yt.boldStyle,whiteSpace:"nowrap"}},void 0,a()(f.ZP,{icon:e.icon,type:e.type,size:12,style:Yt.svgIconStyle,theme:t}),e.name)}renderCollectionViewTitle(e){if(!e.isDefined())return;const t=e.getModel().getRenderUrl({getRecordModel:this.getRecordModel}),i=e.getFormat().collection_view_icon,o=e.getType();return a()(Ve.Z,{href:t,onClick:()=>this.trackTitleClick(),external:!1,innerStyle:{...Yt.pageLinkStyle,...Yt.boldStyle},inline:!0},void 0,a()(Lt.F,{viewIcon:i,viewType:o,color:"light",style:{display:"inline-block",verticalAlign:"middle",marginRight:4,marginBottom:2},size:12}),a()(Ut.Z,{collectionViewName:e.getName(),collectionViewType:e.getType()}))}renderTitle(e){const t=e.getModel();if(!t)return;const i=t.getRenderIcon({getRecordModel:this.getRecordModel}),o=this.withPageVisitSource(t.getRenderUrl({getRecordModel:this.getRecordModel}));return a()(Ve.Z,{href:o,onClick:()=>this.trackTitleClick(),external:!1,innerStyle:Yt.pageLinkStyle,inline:!0},void 0,i&&c.createElement(c.Fragment,null,a()(lt.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:18,style:Yt.recordIconStyle}),a()("span",{},void 0," ")),a()(ht.Z,{store:e,style:this.getActivityTitleStyle(void 0!==i)}))}renderTeamTitle(e){if(!e.isDefined())return;const t=e.getModel().getRenderIcon({getRecordModel:this.getRecordModel});return a()(Ve.Z,{onClick:t=>{this.trackBodyClick(),F.hI({environment:this.environment,teamStore:e,shouldScroll:!0}),j.Z.setState({...j.Z.state,open:!1})},external:!1,innerStyle:Yt.pageLinkStyle,inline:!0},void 0,t&&c.createElement(c.Fragment,null,a()(lt.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:18,style:Yt.recordIconStyle}),a()("span",{},void 0," ")),a()(ht.Z,{store:e,style:this.getActivityTitleStyle(void 0!==t)}))}renderPermissionGroupTitle(e,t){let i,o;return e?(i=e.icon,o=e.name||a()(L.FormattedMessage,{defaultMessage:"Untitled group",id:"activity.permissionGroupTitles.untitledGroup"})):o=a()(L.FormattedMessage,{defaultMessage:"Deleted group",id:"activity.permissionGroupTitles.deletedGroup"}),a()("span",{},void 0,i&&a()(lt.Z,{disabled:!0,icon:{icon:i,pointer:{table:"space",id:t}},isEmptyPage:!1,size:18,style:Yt.recordIconStyle}),a()("span",{style:this.getActivityTitleStyle(void 0!==i)},void 0,o))}renderPermissionGroupEditedHeader(e){const{activity:t,authors:i,groupName:o}=e,r=De(i),n=(0,D.hI)(t.edits||[])[0];return n?"permission-group-created"===n.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created group {groupName}} other {{authorOrAuthors} created group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:a()("span",{style:Yt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-group-deleted"===n.type?a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted group {groupName}} other {{authorOrAuthors} deleted group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:a()("span",{style:Yt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:a()("span",{style:Yt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEditedDefault.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):a()(L.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:a()("span",{style:Yt.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEdit.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}canUnarchive(){const{notification:e}=this.props;return!!e&&!!e.visited}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}getBlockStore(e){return $.G.createChildStore(this.props.rootStore,{table:k.iU,id:e})}getAuthors(e){const t=d().uniqWith(d().flatten(e.map((e=>e.authors||[]))),d().isEqual);return d().compact(t.map(this.getAuthorActor))}handleTrackBacklinkClick(e){V.EQ({...this.getBaseNotificationArgs(),backlinkPageId:e})}handleTrackArchiveClicked(){V._b(this.getBaseNotificationArgs())}handleNotificationFrameClicked(){V.ix(this.getBaseNotificationArgs())}handleMarkAsReadClicked(){V.cC(this.getBaseNotificationArgs())}getBaseNotificationArgs(){const{notification:e,activity:t,tab:i}=this.props;return{environment:this.environment,activity:t,notificationId:null==e?void 0:e.id,alreadyRead:Boolean(null==e?void 0:e.read),tab:i}}getActivitySectionHandlers(){return{onBacklinkClicked:this.handleTrackBacklinkClick,onArchiveClicked:this.handleTrackArchiveClicked,onMarkAsReadClicked:this.handleMarkAsReadClicked,onMarkAsUnreadClicked:this.handleMarkAsUnreadClicked,onNotificationFrameClicked:this.handleNotificationFrameClicked}}trackTitleClick(){this.trackClick({target:"title",tab:this.props.tab,mightCloseTab:!0})}trackBodyClick(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mightCloseTab:!0};const{mightCloseTab:t}=e;this.trackClick({target:"body",tab:this.props.tab,mightCloseTab:t})}trackClick(e){const{target:t,tab:i,mightCloseTab:o}=e,{notification:r}=this.props,n="notifications_tab"===this.props.source?Y.Z.state.sessionId:void 0,a="notifications_tab"===this.props.source?Y.Z.isFilteredToUnreadOnly():void 0;U.trackClickUpdate(this.environment,{target:t,activity_id:this.props.activity.id,notification_id:null==r?void 0:r.id,sessionId:n,is_filtered:a,tab:i}),o&&V.pw({environment:this.environment,target:t}),r&&g.e((0,K.getClientEventTracker)(this.environment),{alreadyRead:r.read,notificationId:r.id,activityId:r.activity_id,from:t,sessionId:n})}getIsRecordPrivateToUser(e,t){if("notifications_tab"!==this.props.source)return!1;if("all"!==this.props.tab)return!1;if(!e)return!1;let i;return i="block"===t?$.G.createChildStore(this.props.rootStore,{table:k.iU,id:e}):"collection"===t?$.NW.createChildStore(this.props.rootStore,{table:_.v,id:e}):$.H2.createChildStore(this.props.rootStore,{table:C.bx,id:e}),(0,H.yi)(this.environment,i)}getActionContainerStyle(){return{paddingLeft:this.getActivityContentLeftPadding()-8,paddingTop:4}}getActionPrimaryContainerStyle(){return{paddingLeft:this.getActivityContentLeftPadding(),paddingTop:12,paddingBottom:8}}getEditButtonStyle(){return{padding:0,paddingLeft:this.getActivityContentLeftPadding(),paddingRight:16,...Yt.canSelectStyle}}getActivityContentLeftPadding(){return this.isInboxTab()?52+(this.environment.device.isMobile?3:2):52}isInboxTab(){return"notifications_tab"===this.props.source&&"inbox"===this.props.tab}getActionButtonStyle(){return{boxShadow:this.theme.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:this.theme.regularTextColor}}getActionSecondaryButtonStyle(){return{height:26,paddingLeft:8,paddingRight:8,color:this.theme.mediumTextColor}}getInviteMessageStyle(){return{paddingLeft:this.getActivityContentLeftPadding(),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}}getActivityTitleStyle(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...Yt.boldStyle}}}Yt.displayName="Activity",Yt.canSelectStyle={userSelect:"text",WebkitUserSelect:"text"},Yt.boldStyle={fontWeight:P.Z.fontWeight.semibold},Yt.pageLinkStyle={padding:1,...Yt.canSelectStyle},Yt.recordIconStyle={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},Yt.svgIconStyle={width:12,height:12,display:"inline-block",verticalAlign:"middle",marginBottom:2,marginRight:4};const Xt=Yt},98905:(e,t,i)=>{i.d(t,{Z:()=>n});var o=i(49085);class r extends o.Z{getInitialState(){return{count:0}}}const n=new r}}]);